/**
 * MT Loader Component - BEM Structure
 * 
 * A flexible loading indicator component with various styles and animations
 * Zero !important declarations - uses CSS cascade layers for specificity
 * 
 * @since 3.0.0
 */

@layer components {
    /* ========================================================================
       Loader Block
       ======================================================================== */
    
    .mt-loader {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: var(--mt-spacing-md, 16px);
        padding: var(--mt-spacing-xl, 32px);
        min-height: 200px;
        position: relative;
    }
    
    /* ========================================================================
       Loader Elements
       ======================================================================== */
    
    /* Spinner Container */
    .mt-loader__spinner {
        width: 48px;
        height: 48px;
        position: relative;
        display: inline-block;
    }
    
    /* Default Spinner (Circular) */
    .mt-loader__spinner::before {
        content: '';
        display: block;
        width: 100%;
        height: 100%;
        border: 4px solid var(--mt-blue-accent, #A4DCD5);
        border-top-color: var(--mt-accent, #C1693C);
        border-radius: 50%;
        animation: mt-loader-spin 1s linear infinite;
    }
    
    @keyframes mt-loader-spin {
        to {
            transform: rotate(360deg);
        }
    }
    
    /* Loading Text */
    .mt-loader__text {
        font-size: var(--mt-font-size-base, 1rem);
        font-weight: var(--mt-font-weight-medium, 500);
        color: var(--mt-body-text, #302C37);
        text-align: center;
        margin: 0;
    }
    
    /* Progress Bar */
    .mt-loader__progress {
        width: 100%;
        max-width: 300px;
        height: 8px;
        background: var(--mt-bg-beige, #F5E6D3);
        border-radius: var(--mt-radius-full, 9999px);
        overflow: hidden;
        position: relative;
    }
    
    .mt-loader__progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--mt-accent, #C1693C) 0%, var(--mt-primary, #003C3D) 100%);
        border-radius: var(--mt-radius-full, 9999px);
        transition: width 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .mt-loader__progress-bar::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
            90deg,
            transparent,
            rgba(255, 255, 255, 0.3),
            transparent
        );
        animation: mt-loader-shimmer 2s linear infinite;
    }
    
    @keyframes mt-loader-shimmer {
        from {
            transform: translateX(-100%);
        }
        to {
            transform: translateX(100%);
        }
    }
    
    /* Progress Percentage */
    .mt-loader__percentage {
        font-size: var(--mt-font-size-sm, 0.875rem);
        font-weight: var(--mt-font-weight-semibold, 600);
        color: var(--mt-primary, #003C3D);
        margin-top: var(--mt-spacing-sm, 8px);
    }
    
    /* Dots Animation */
    .mt-loader__dots {
        display: flex;
        gap: var(--mt-spacing-sm, 8px);
        align-items: center;
    }
    
    .mt-loader__dot {
        width: 12px;
        height: 12px;
        background: var(--mt-accent, #C1693C);
        border-radius: 50%;
        animation: mt-loader-bounce 1.4s ease-in-out infinite both;
    }
    
    .mt-loader__dot:nth-child(1) {
        animation-delay: -0.32s;
    }
    
    .mt-loader__dot:nth-child(2) {
        animation-delay: -0.16s;
    }
    
    @keyframes mt-loader-bounce {
        0%, 80%, 100% {
            transform: scale(0.8);
            opacity: 0.5;
        }
        40% {
            transform: scale(1);
            opacity: 1;
        }
    }
    
    /* Pulse Animation */
    .mt-loader__pulse {
        width: 48px;
        height: 48px;
        background: var(--mt-accent, #C1693C);
        border-radius: 50%;
        position: relative;
    }
    
    .mt-loader__pulse::before,
    .mt-loader__pulse::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--mt-accent, #C1693C);
        border-radius: 50%;
        opacity: 0.6;
        animation: mt-loader-pulse 2s ease-out infinite;
    }
    
    .mt-loader__pulse::after {
        animation-delay: 1s;
    }
    
    @keyframes mt-loader-pulse {
        0% {
            transform: scale(1);
            opacity: 0.6;
        }
        100% {
            transform: scale(2);
            opacity: 0;
        }
    }
    
    /* Bars Animation */
    .mt-loader__bars {
        display: flex;
        gap: var(--mt-spacing-xs, 4px);
        align-items: flex-end;
        height: 40px;
    }
    
    .mt-loader__bar {
        width: 8px;
        background: var(--mt-primary, #003C3D);
        animation: mt-loader-bars 1s ease-in-out infinite;
    }
    
    .mt-loader__bar:nth-child(1) {
        animation-delay: 0s;
    }
    
    .mt-loader__bar:nth-child(2) {
        animation-delay: 0.1s;
    }
    
    .mt-loader__bar:nth-child(3) {
        animation-delay: 0.2s;
    }
    
    .mt-loader__bar:nth-child(4) {
        animation-delay: 0.3s;
    }
    
    .mt-loader__bar:nth-child(5) {
        animation-delay: 0.4s;
    }
    
    @keyframes mt-loader-bars {
        0%, 100% {
            height: 20px;
        }
        50% {
            height: 40px;
        }
    }
    
    /* Icon */
    .mt-loader__icon {
        width: 64px;
        height: 64px;
        fill: var(--mt-accent, #C1693C);
        animation: mt-loader-spin 2s linear infinite;
    }
    
    /* ========================================================================
       Loader Modifiers
       ======================================================================== */
    
    /* Size Variations */
    .mt-loader--small {
        min-height: 100px;
        padding: var(--mt-spacing-md, 16px);
    }
    
    .mt-loader--small .mt-loader__spinner {
        width: 24px;
        height: 24px;
    }
    
    .mt-loader--small .mt-loader__spinner::before {
        border-width: 2px;
    }
    
    .mt-loader--small .mt-loader__text {
        font-size: var(--mt-font-size-sm, 0.875rem);
    }
    
    .mt-loader--small .mt-loader__dots .mt-loader__dot {
        width: 8px;
        height: 8px;
    }
    
    .mt-loader--large {
        min-height: 300px;
    }
    
    .mt-loader--large .mt-loader__spinner {
        width: 64px;
        height: 64px;
    }
    
    .mt-loader--large .mt-loader__spinner::before {
        border-width: 6px;
    }
    
    .mt-loader--large .mt-loader__text {
        font-size: var(--mt-font-size-lg, 1.125rem);
    }
    
    .mt-loader--large .mt-loader__dots .mt-loader__dot {
        width: 16px;
        height: 16px;
    }
    
    /* Inline Loader */
    .mt-loader--inline {
        display: inline-flex;
        min-height: auto;
        padding: 0;
        gap: var(--mt-spacing-sm, 8px);
        vertical-align: middle;
    }
    
    .mt-loader--inline .mt-loader__spinner {
        width: 16px;
        height: 16px;
    }
    
    .mt-loader--inline .mt-loader__spinner::before {
        border-width: 2px;
    }
    
    .mt-loader--inline .mt-loader__text {
        font-size: var(--mt-font-size-sm, 0.875rem);
    }
    
    /* Fullscreen Loader */
    .mt-loader--fullscreen {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--mt-overlay-bg, rgba(0, 76, 95, 0.8));
        backdrop-filter: blur(4px);
        z-index: var(--mt-z-modal, 1050);
        min-height: 100vh;
    }
    
    .mt-loader--fullscreen .mt-loader__spinner {
        width: 80px;
        height: 80px;
    }
    
    .mt-loader--fullscreen .mt-loader__spinner::before {
        border-width: 8px;
    }
    
    .mt-loader--fullscreen .mt-loader__text {
        color: white;
        font-size: var(--mt-font-size-xl, 1.25rem);
    }
    
    /* Overlay Loader */
    .mt-loader--overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(2px);
        z-index: var(--mt-z-sticky, 1020);
        min-height: 100%;
    }
    
    /* Color Variations */
    .mt-loader--primary .mt-loader__spinner::before {
        border-color: var(--mt-primary, #003C3D);
        border-top-color: var(--mt-accent, #C1693C);
    }
    
    .mt-loader--secondary .mt-loader__spinner::before {
        border-color: var(--mt-secondary, #004C5F);
        border-top-color: var(--mt-blue-accent, #A4DCD5);
    }
    
    .mt-loader--success .mt-loader__spinner::before {
        border-color: rgba(40, 167, 69, 0.2);
        border-top-color: var(--mt-success, #28a745);
    }
    
    .mt-loader--warning .mt-loader__spinner::before {
        border-color: rgba(255, 193, 7, 0.2);
        border-top-color: var(--mt-warning, #ffc107);
    }
    
    .mt-loader--error .mt-loader__spinner::before {
        border-color: rgba(220, 53, 69, 0.2);
        border-top-color: var(--mt-error, #dc3545);
    }
    
    /* Light Theme */
    .mt-loader--light {
        background: white;
    }
    
    .mt-loader--light .mt-loader__text {
        color: var(--mt-body-text, #302C37);
    }
    
    /* Dark Theme */
    .mt-loader--dark {
        background: var(--mt-secondary, #004C5F);
    }
    
    .mt-loader--dark .mt-loader__text {
        color: white;
    }
    
    .mt-loader--dark .mt-loader__spinner::before {
        border-color: rgba(255, 255, 255, 0.2);
        border-top-color: white;
    }
    
    /* Hidden State */
    .mt-loader--hidden {
        display: none;
    }
    
    /* Fade Animation */
    .mt-loader--fade {
        animation: mt-loader-fade-in 0.3s ease;
    }
    
    @keyframes mt-loader-fade-in {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }
    
    /* Different Spinner Types */
    
    /* Dots Spinner */
    .mt-loader--dots .mt-loader__spinner::before {
        display: none;
    }
    
    .mt-loader--dots .mt-loader__spinner {
        width: auto;
        height: auto;
    }
    
    /* Bars Spinner */
    .mt-loader--bars .mt-loader__spinner::before {
        display: none;
    }
    
    .mt-loader--bars .mt-loader__spinner {
        width: auto;
        height: 40px;
    }
    
    /* Pulse Spinner */
    .mt-loader--pulse .mt-loader__spinner::before {
        display: none;
    }
    
    /* Square Spinner */
    .mt-loader--square .mt-loader__spinner::before {
        border-radius: var(--mt-radius-md, 8px);
        animation: mt-loader-square 1.2s ease-in-out infinite;
    }
    
    @keyframes mt-loader-square {
        0% {
            transform: perspective(120px) rotateX(0deg) rotateY(0deg);
        }
        50% {
            transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg);
        }
        100% {
            transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);
        }
    }
    
    /* ========================================================================
       Responsive Design
       ======================================================================== */
    
    @media (max-width: 768px) {
        .mt-loader {
            padding: var(--mt-spacing-lg, 24px);
        }
        
        .mt-loader__progress {
            max-width: 200px;
        }
    }
    
    @media (max-width: 576px) {
        .mt-loader {
            padding: var(--mt-spacing-md, 16px);
            min-height: 150px;
        }
        
        .mt-loader__spinner {
            width: 36px;
            height: 36px;
        }
        
        .mt-loader__spinner::before {
            border-width: 3px;
        }
        
        .mt-loader__text {
            font-size: var(--mt-font-size-sm, 0.875rem);
        }
        
        .mt-loader--fullscreen .mt-loader__spinner {
            width: 60px;
            height: 60px;
        }
        
        .mt-loader--fullscreen .mt-loader__spinner::before {
            border-width: 6px;
        }
    }
    
    /* ========================================================================
       Accessibility
       ======================================================================== */
    
    .mt-loader[role="status"] {
        position: relative;
    }
    
    .mt-loader__sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }
}