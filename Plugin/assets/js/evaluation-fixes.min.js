jQuery(document).ready(function(n){"use strict";function t(){var t=0,e=0;n(".mt-score-slider").each(function(){var o=parseFloat(n(this).val());isNaN(o)||(t+=o,e++)});var o,i,r=e>0?(t/e).toFixed(1):0;n("#mt-total-score").text(r),o=r,(i=n(".mt-total-score-display")).removeClass("score-low score-medium score-high"),o<4?i.addClass("score-low"):o<7?i.addClass("score-medium"):i.addClass("score-high")}var e=!1;function o(){n("#mt-evaluation-form").on("submit",function(t){if(t.preventDefault(),e)return!1;e=!0;var o=n(this),r=new FormData(this);r.append("action","mt_save_evaluation"),n(".mt-score-slider").each(function(){var t=n(this).attr("name"),e=n(this).val();r.set(t,e)});var a=o.find('button[type="submit"]'),s=a.html(),d=window.getI18nText?window.getI18nText("submitting","Submitting..."):mt_frontend&&mt_frontend.i18n&&mt_frontend.i18n.submitting?mt_frontend.i18n.submitting:"Submitting...";a.prop("disabled",!0).html('<span class="dashicons dashicons-update spin"></span> '+d),n.ajax({url:mt_ajax.ajax_url,type:"POST",data:r,processData:!1,contentType:!1,success:function(t){t.success?(i("success",t.data.message||(window.getI18nText?window.getI18nText("evaluation_submitted","Thank you for submitting your evaluation!"):mt_frontend&&mt_frontend.i18n&&mt_frontend.i18n.evaluation_submitted_full?mt_frontend.i18n.evaluation_submitted_full:mt_frontend&&mt_frontend.i18n&&mt_frontend.i18n.evaluation_submitted?mt_frontend.i18n.evaluation_submitted:"Thank you for submitting your evaluation!")),function(t){var e=n(".mt-status-badge");0===e.length&&(e=n('<span class="mt-status-badge"></span>'),n(".mt-evaluation-title").append(e));if(e.removeClass("mt-status-draft mt-status-completed").addClass("mt-status-"+t),"draft"===t)e.text("Draft Saved");else if("completed"===t){var o=mt_frontend&&mt_frontend.i18n&&mt_frontend.i18n.evaluation_submitted_status?mt_frontend.i18n.evaluation_submitted_status:"Evaluation Submitted";e.text(o)}}("completed"),setTimeout(function(){window.location.href=t.data.redirect||window.location.href.split("?")[0]},2e3)):(i("error",t.data||(window.getI18nText?window.getI18nText("error","An error occurred. Please try again."):mt_frontend&&mt_frontend.i18n&&mt_frontend.i18n.error_try_again?mt_frontend.i18n.error_try_again:"An error occurred. Please try again.")),a.prop("disabled",!1).html(s),e=!1)},error:function(){i("error",window.getI18nText?window.getI18nText("network_error","Network error. Please check your connection and try again."):mt_frontend&&mt_frontend.i18n&&mt_frontend.i18n.network_error?mt_frontend.i18n.network_error:"Network error. Please check your connection and try again."),a.prop("disabled",!1).html(s),e=!1}})})}function i(t,e){n(".mt-notification").remove();var o=n('<div class="mt-notification mt-notification-'+t+'"><span class="dashicons dashicons-'+("success"===t?"yes":"warning")+'"></span> '+e+"</div>");n("body").append(o),setTimeout(function(){o.addClass("show")},100),setTimeout(function(){o.removeClass("show"),setTimeout(function(){o.remove()},300)},5e3)}function r(){0===n("#mt-critical-fixes-styles").length&&n("head").append('\n                <style id="mt-critical-fixes-styles">\n                    /* Slider Styles */\n                    .mt-score-slider-container {\n                        position: relative;\n                        margin: 20px 0;\n                    }\n                    .mt-score-slider {\n                        width: 100%;\n                        height: 6px;\n                        -webkit-appearance: none;\n                        appearance: none;\n                        background: #ddd;\n                        border-radius: 3px;\n                        outline: none;\n                    }\n                    .mt-score-slider::-webkit-slider-thumb {\n                        -webkit-appearance: none;\n                        appearance: none;\n                        width: 20px;\n                        height: 20px;\n                        background: #4CAF50;\n                        border-radius: 50%;\n                        cursor: pointer;\n                    }\n                    .mt-score-slider::-moz-range-thumb {\n                        width: 20px;\n                        height: 20px;\n                        background: #4CAF50;\n                        border-radius: 50%;\n                        cursor: pointer;\n                        border: none;\n                    }\n                    .mt-slider-value {\n                        position: absolute;\n                        top: -25px;\n                        left: 50%;\n                        transform: translateX(-50%);\n                        background: #333;\n                        color: white;\n                        padding: 2px 8px;\n                        border-radius: 3px;\n                        font-size: 12px;\n                    }\n                    /* Score Display */\n                    .mt-total-score-display {\n                        float: right;\n                        font-size: 1.2em;\n                        font-weight: bold;\n                        padding: 5px 10px;\n                        border-radius: 5px;\n                        background: #f0f0f0;\n                    }\n                    .mt-total-score-display.score-low {\n                        background: #ffebee;\n                        color: #c62828;\n                    }\n                    .mt-total-score-display.score-medium {\n                        background: #fff3e0;\n                        color: #ef6c00;\n                    }\n                    .mt-total-score-display.score-high {\n                        background: #e8f5e9;\n                        color: #2e7d32;\n                    }\n                    /* Notification Styles */\n                    .mt-notification {\n                        position: fixed;\n                        top: 50px;\n                        right: -300px;\n                        background: white;\n                        padding: 15px 20px;\n                        border-radius: 4px;\n                        box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n                        z-index: 9999;\n                        transition: right 0.3s ease;\n                        max-width: 300px;\n                    }\n                    .mt-notification.show {\n                        right: 20px;\n                    }\n                    .mt-notification-success {\n                        border-left: 4px solid #4CAF50;\n                        color: #2e7d32;\n                    }\n                    .mt-notification-error {\n                        border-left: 4px solid #f44336;\n                        color: #c62828;\n                    }\n                    /* Character Count */\n                    .mt-char-count {\n                        text-align: right;\n                        font-size: 0.9em;\n                        color: #666;\n                        margin-top: 5px;\n                    }\n                    .mt-char-count.over-limit {\n                        color: #f44336;\n                        font-weight: bold;\n                    }\n                    /* Loading Spinner */\n                    .dashicons.spin {\n                        animation: spin 1s linear infinite;\n                    }\n                    @keyframes spin {\n                        from { transform: rotate(0deg); }\n                        to { transform: rotate(360deg); }\n                    }\n                    /* Fix Bio Content */\n                    .mt-bio-content:empty::before {\n                        content: "Biography information not available.";\n                        color: #999;\n                        font-style: italic;\n                    }\n                    .no-content {\n                        color: #999;\n                        font-style: italic;\n                    }\n                </style>\n            '),n(".mt-button-group").each(function(){var t=n(this),e=t.data("criterion"),o=t.find('input[type="hidden"]').val()||5,i=`\n                <div class="mt-score-slider-container">\n                    <input type="range" \n                           name="${e}_score" \n                           class="mt-score-slider" \n                           min="0" \n                           max="10" \n                           step="0.5"\n                           value="${o}"\n                           data-criterion="${e}">\n                    <div class="mt-slider-value">${o}</div>\n                </div>\n            `;t.replaceWith(i)}),n(".mt-score-slider").on("input change",function(){var e=n(this),o=e.val();e.siblings(".mt-slider-value").text(o),e.closest(".mt-criterion-card").find(".mt-score-value").text(o),t()}),t(),function(){var t=n(".mt-bio-content");if(t.length&&""===t.text().trim()){var e=t.data("biography")||n("#candidate-biography").val()||n(".mt-candidate-bio-hidden").text();e&&""!==e.trim()?t.html("<p>"+e+"</p>"):t.html('<p class="no-content">No biography available for this candidate.</p>')}}(),o(),function(){var t=n("#mt-comments"),e=n("#mt-char-current");function o(){var n=t.val().length;e.text(n),n>1e3?e.parent().addClass("over-limit"):e.parent().removeClass("over-limit")}t.on("input keyup",o),o()}()}n(".mt-evaluation-form, #mt-evaluation-form").length>0&&r(),n(document).ajaxComplete(function(n,t,e){e.url&&e.url.includes("evaluate")&&setTimeout(r,100)})});