(r=>{r(document).ready(function(){function o(){r(".mt-score-slider").off(".mt-evaluation"),r(document).off("input.mt-evaluation change.mt-evaluation",".mt-score-slider"),r(".mt-score-slider").each(function(){var t,e=r(this);e.attr("name")&&(e.off("change.mt-evaluation input.mt-evaluation"),e.on("input.mt-evaluation change.mt-evaluation",function(t){t.stopPropagation();t=r(this).val(),r(this).closest(".mt-criterion-card").find(".mt-score-value").text(t),t=t/10*100;r(this).css("background","linear-gradient(to right, #667eea 0%, #667eea "+t+"%, #e5e7eb "+t+"%, #e5e7eb 100%)"),n()}),t=e.val()/10*100,e.css("background","linear-gradient(to right, #667eea 0%, #667eea "+t+"%, #e5e7eb "+t+"%, #e5e7eb 100%)"))})}function i(){r(".mt-score-mark").off("click.mt-evaluation"),r(".mt-score-mark").on("click.mt-evaluation",function(t){t.preventDefault(),t.stopPropagation();t=r(this).data("value");r(this).closest(".mt-criterion-card").find(".mt-score-slider").val(t).trigger("input"),r(this).addClass("selected").siblings().removeClass("selected")})}function n(){var t,e=0,a=0;r(".mt-score-slider").each(function(){var t=parseFloat(r(this).val());isNaN(t)||(e+=t,a++)}),0===a&&r(".mt-button-group").each(function(){var t=r(this).find('input[type="hidden"]'),t=parseFloat(t.val());isNaN(t)||(e+=t,a++)}),0<a&&(t=(e/a).toFixed(1),r("#mt-total-score").text(t),r(".mt-total-score-value").text(t),r(".mt-average-score").text(t+"/10"),r(".mt-evaluated-count").text("("+a+"/5 criteria evaluated)"))}function t(){setTimeout(function(){r(".mt-score-slider").off(".mt-evaluation"),r(document).off("input.mt-evaluation change.mt-evaluation",".mt-score-slider"),r(".mt-score-button").off(".mt-evaluation"),r(document).off("click.mt-evaluation",".mt-score-button"),r(".mt-score-mark").off(".mt-evaluation"),0<r(".mt-button-group").length&&(r(".mt-score-button").off(".mt-evaluation"),r(document).off("click.mt-evaluation",".mt-score-button"),r(".mt-button-group").each(function(){var a=r(this),o=(a.data("criterion"),a.find('input[type="hidden"]'));a.find(".mt-score-button").on("click.mt-evaluation",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var t=r(this),e=t.data("value");a.find(".mt-score-button").removeClass("active selected"),t.addClass("active selected"),o.val(e),a.closest(".mt-criterion-card").find(".mt-score-value").text(e),n(),"undefined"!=typeof MTJuryDashboard&&MTJuryDashboard.updateTotalScore&&MTJuryDashboard.updateTotalScore()})})),0<r(".mt-score-slider").length&&o(),i(),n(),r("#mt-evaluation-form").off("submit.mt-evaluation").on("submit.mt-evaluation",function(t){var a=!0,o=[];if(r(".mt-score-slider").each(function(){var t=parseFloat(r(this).val()),e=r(this).attr("name");!isNaN(t)&&0!==t||(a=!1,o.push(e.replace("_score","")))}),!a&&5===o.length)return t.preventDefault(),alert("Please rate at least one criterion before submitting."),!1}),r(document).off("ajaxComplete.mt-evaluation").on("ajaxComplete.mt-evaluation",function(t,e,a){a.url&&(a.url.includes("evaluate")||a.url.includes("mt_get_candidate"))&&setTimeout(function(){o(),i(),n()},100)}),window.location.search.includes("debug=1")&&(r("body").append('<div id="evaluation-debug" style="position:fixed;bottom:10px;right:10px;background:#fff;border:2px solid #000;padding:10px;z-index:9999;"><h4>Evaluation Debug</h4><div id="debug-values"></div></div>'),setInterval(function(){var t="";r(".mt-score-slider").each(function(){t+=r(this).attr("name")+": "+r(this).val()+"<br>"}),r("#debug-values").html(t)},1e3))},750)}t(),r(window).off("load.mt-evaluation").on("load.mt-evaluation",function(){0<r(".mt-score-slider").length&&t()}),window.MTEvaluationFix={reinitialize:t}})})(jQuery);