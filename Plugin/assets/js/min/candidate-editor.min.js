!function(t){"use strict";var e={currentPostId:null,originalContent:{},hasUnsavedChanges:!1,activeEditors:{},init:function(){this.bindEvents()},bindEvents:function(){var e=this;t(document).on("click",".mt-inline-edit-btn",function(i){i.preventDefault();var n=t(this).data("post-id");e.openEditModal(n)}),t(document).on("click",".mt-tab-btn",function(){var i=t(this).data("tab");e.switchTab(i)}),t(document).on("click",".mt-save-content",function(){e.saveContent()}),t(document).on("click",".mt-cancel-edit",function(){e.closeModal()}),t("#mt-inline-edit-modal").on("click",function(t){t.target===this&&e.closeModal()}),t(document).on("keydown",function(i){"Escape"===i.key&&t("#mt-inline-edit-modal").is(":visible")&&e.closeModal()})},openEditModal:function(e){var i=this;this.currentPostId=e,t("#mt-inline-edit-modal").show(),t(".mt-modal-body").html('<div style="text-align:center;padding:50px;">Loading...</div>'),t.ajax({url:ajaxurl,type:"POST",data:{action:"mt_get_candidate_content",post_id:e,nonce:t("#mt_candidate_editor_nonce").val()||mtCandidateEditor.nonce},success:function(t){t.success?i.populateModal(t.data):(alert(t.data.message||(mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n.error_loading_content?mt_ajax.i18n.error_loading_content:"Error loading content")),i.closeModal())},error:function(){alert(mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n.error_loading_content?mt_ajax.i18n.error_loading_content:"Error loading content"),i.closeModal()}})},populateModal:function(e){var i=this;i.originalContent={overview:e.overview||"",criteria:e.criteria||""},i.hasUnsavedChanges=!1;t(".mt-modal-body").html('<div class="mt-tab-content active" data-content="overview"><div class="mt-editor-container"><textarea id="mt-edit-overview" class="mt-rich-editor" rows="10" style="width:100%;"></textarea></div></div><div class="mt-tab-content" data-content="criteria" style="display:none;"><div style="margin-bottom:10px;"><button type="button" class="button mt-insert-template">Insert Criteria Template</button></div><div class="mt-editor-container"><textarea id="mt-edit-criteria" class="mt-rich-editor" rows="15" style="width:100%;"></textarea></div><div style="margin-top:10px;padding:10px;background:#f0f0f0;border-radius:3px;font-size:12px;"><strong>Format Tips:</strong><br>Use bold text for criteria headers (e.g., <strong>Mut & Pioniergeist:</strong>)<br>Add line breaks between sections for better readability</div></div>'),t("#mt-edit-overview").val(e.overview||""),t("#mt-edit-criteria").val(e.criteria||""),setTimeout(function(){i.initRichEditors()},100),t(".mt-insert-template").on("click",function(){i.insertCriteriaTemplate()}),this.switchTab("overview")},initRichEditors:function(){var e=this;e.destroyEditors();var i={tinymce:{wpautop:!0,plugins:"lists,link,wordpress,wplink,wptextpattern",toolbar1:"formatselect,bold,italic,bullist,numlist,blockquote,alignleft,aligncenter,alignright,link,unlink,wp_more,spellchecker,fullscreen,wp_adv",toolbar2:"strikethrough,hr,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help",height:300,setup:function(t){e.activeEditors.overview=t,t.on("change keyup",function(){e.hasUnsavedChanges=!0})}},quicktags:!0,mediaButtons:!0},n={tinymce:{wpautop:!0,plugins:"lists,link,wordpress,wplink,wptextpattern",toolbar1:"formatselect,bold,italic,bullist,numlist,blockquote,alignleft,aligncenter,alignright,link,unlink,wp_more,spellchecker,fullscreen,wp_adv",toolbar2:"strikethrough,hr,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help",height:400,setup:function(t){e.activeEditors.criteria=t,t.on("change keyup",function(){e.hasUnsavedChanges=!0})}},quicktags:!0,mediaButtons:!1};"undefined"!=typeof wp&&wp.editor?(wp.editor.remove("mt-edit-overview"),wp.editor.remove("mt-edit-criteria"),wp.editor.initialize("mt-edit-overview",i),wp.editor.initialize("mt-edit-criteria",n)):"undefined"!=typeof tinymce?(tinymce.remove("#mt-edit-overview"),tinymce.remove("#mt-edit-criteria"),tinymce.init({selector:"#mt-edit-overview",height:300,menubar:!1,plugins:"lists link wordpress wplink",toolbar:"formatselect | bold italic | bullist numlist | link unlink | removeformat",content_css:!1,setup:function(t){e.activeEditors.overview=t,t.on("change keyup",function(){e.hasUnsavedChanges=!0})}}),tinymce.init({selector:"#mt-edit-criteria",height:400,menubar:!1,plugins:"lists link wordpress wplink",toolbar:"formatselect | bold italic | bullist numlist | link unlink | removeformat",content_css:!1,setup:function(t){e.activeEditors.criteria=t,t.on("change keyup",function(){e.hasUnsavedChanges=!0})}})):(console.warn("WordPress editor not available, using plain textareas"),t("#mt-edit-overview").on("input",function(){e.hasUnsavedChanges=!0}),t("#mt-edit-criteria").on("input",function(){e.hasUnsavedChanges=!0}))},destroyEditors:function(){"undefined"!=typeof wp&&wp.editor?(wp.editor.remove("mt-edit-overview"),wp.editor.remove("mt-edit-criteria")):"undefined"!=typeof tinymce&&(tinymce.remove("#mt-edit-overview"),tinymce.remove("#mt-edit-criteria")),this.activeEditors={}},insertCriteriaTemplate:function(){var e="<strong>Mut & Pioniergeist:</strong><br>\n[Content here]<br><br>\n<strong>Innovationsgrad:</strong><br>\n[Content here]<br><br>\n<strong>Umsetzungskraft & Wirkung:</strong><br>\n[Content here]<br><br>\n<strong>Relevanz für die Mobilitätswende:</strong><br>\n[Content here]<br><br>\n<strong>Vorbildfunktion & Sichtbarkeit:</strong><br>\n[Content here]";if("undefined"!=typeof wp&&wp.editor){if(wp.editor.getContent("mt-edit-criteria")&&!confirm("This will replace the current content. Continue?"))return;wp.editor.setContent(e,"mt-edit-criteria"),this.hasUnsavedChanges=!0}else if(this.activeEditors.criteria){if(this.activeEditors.criteria.getContent()&&!confirm("This will replace the current content. Continue?"))return;this.activeEditors.criteria.setContent(e),this.hasUnsavedChanges=!0}else{var i=t("#mt-edit-criteria");if(i.val()&&!confirm("This will replace the current content. Continue?"))return;i.val(e).trigger("input")}},switchTab:function(e){t(".mt-tab-btn").removeClass("active"),t('.mt-tab-btn[data-tab="'+e+'"]').addClass("active"),t(".mt-tab-content").hide(),t('.mt-tab-content[data-content="'+e+'"]').show(),this.activeEditors[e]&&this.activeEditors[e].focus()},getEditorContent:function(e){if("undefined"!=typeof wp&&wp.editor)return wp.editor.getContent(e);if("undefined"!=typeof tinymce){var i=tinymce.get(e);if(i)return i.getContent()}return t("#"+e).val()},saveContent:function(){var e=this,i=t(".mt-save-content");i.prop("disabled",!0).text("Saving...");var n=t(".mt-tab-btn.active").data("tab"),o="";"overview"===n?o=e.getEditorContent("mt-edit-overview"):"criteria"===n&&(o=e.getEditorContent("mt-edit-criteria")),t.ajax({url:ajaxurl,type:"POST",data:{action:"mt_update_candidate_content",post_id:e.currentPostId,field:n,content:o,nonce:t("#mt_candidate_editor_nonce").val()||mtCandidateEditor.nonce},success:function(a){a.success?(e.originalContent[n]=o,e.hasUnsavedChanges=!1,i.text("Saved!"),"overview"===n&&t("#mt_overview").length?(t("#mt_overview").val(o),"undefined"!=typeof wp&&wp.editor?wp.editor.setContent(o,"mt_overview"):"undefined"!=typeof tinymce&&tinymce.get("mt_overview")&&tinymce.get("mt_overview").setContent(o)):"criteria"===n&&t("#mt_evaluation_criteria").length&&(t("#mt_evaluation_criteria").val(o),"undefined"!=typeof wp&&wp.editor?wp.editor.setContent(o,"mt_evaluation_criteria"):"undefined"!=typeof tinymce&&tinymce.get("mt_evaluation_criteria")&&tinymce.get("mt_evaluation_criteria").setContent(o)),setTimeout(function(){i.prop("disabled",!1).text("Save Changes")},2e3)):(alert(a.data.message||(mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n.error_saving_content?mt_ajax.i18n.error_saving_content:"Error saving content")),i.prop("disabled",!1).text("Save Changes"))},error:function(){alert(mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n.error_saving_content?mt_ajax.i18n.error_saving_content:"Error saving content"),i.prop("disabled",!1).text("Save Changes")}})},closeModal:function(){this.hasUnsavedChanges&&!confirm(mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n.unsaved_changes_warning?mt_ajax.i18n.unsaved_changes_warning:"You have unsaved changes. Are you sure you want to close?")||(this.destroyEditors(),t("#mt-inline-edit-modal").hide(),this.currentPostId=null,this.hasUnsavedChanges=!1)}};t(document).ready(function(){t("#mt-inline-edit-modal").length&&e.init()}),window.MTCandidateEditor=e}(jQuery);
//# sourceMappingURL=candidate-editor.js.map