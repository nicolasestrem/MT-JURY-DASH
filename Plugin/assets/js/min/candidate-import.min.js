jQuery(document).ready(function(e){"use strict";e(document).on("click","#mt-import-candidates",function(a){if(a.preventDefault(),"undefined"!=typeof mt_ajax){var t=e("<input>",{type:"file",accept:".csv,text/csv,application/csv",style:"display: none"});e("body").append(t),t.on("change",function(a){var r=this.files[0];if(r){var i=r.name.toLowerCase();if(!i.endsWith(".csv")){var o=i.split(".").pop();return"xlsx"===o||"xls"===o?alert(mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n.excel_to_csv_message?mt_ajax.i18n.excel_to_csv_message:'Please convert your Excel file to CSV format first. Use "Save As" in Excel and choose "CSV (Comma delimited)" as the file type.'):alert(mt_ajax.i18n.invalid_file_type||"Please select a CSV file."),void t.remove()}if(r.size>10485760)return alert(mt_ajax.i18n.file_too_large||"File is too large. Maximum size is 10MB."),void t.remove();var n=new FormData;n.append("action","mt_import_candidates"),n.append("csv_file",r),n.append("nonce",mt_ajax.nonce),e("#update_existing").length&&n.append("update_existing",e("#update_existing").is(":checked")?"1":"0"),e("#skip_duplicates").length&&n.append("skip_duplicates",e("#skip_duplicates").is(":checked")?"1":"0");var s=e("#mt-import-candidates"),d=s.text();if(s.prop("disabled",!0).text(mt_ajax.i18n.importing||"Importing..."),e(".mt-import-overlay").length)e(".mt-import-overlay").show();else{var p=e("<div>",{class:"mt-import-overlay",style:"position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;"}).html('<div style="background: white; padding: 20px; border-radius: 5px;"><p>'+(mt_ajax.i18n.importing||"Importing...")+'</p><div class="spinner is-active" style="float: none;"></div></div>');e("body").append(p)}e.ajax({url:mt_ajax.ajax_url||ajaxurl,type:"POST",data:n,processData:!1,contentType:!1,success:function(a){if(e(".mt-import-overlay").remove(),s.prop("disabled",!1).text(d),a.success){var r=mt_ajax.i18n.import_complete||"Import complete!";if(a.data){var i=[];a.data.imported>0&&i.push(a.data.imported+" "+(mt_ajax.i18n.created||"created")),a.data.updated>0&&i.push(a.data.updated+" "+(mt_ajax.i18n.updated||"updated")),a.data.skipped>0&&i.push(a.data.skipped+" "+(mt_ajax.i18n.skipped||"skipped")),a.data.errors>0&&i.push(a.data.errors+" "+(mt_ajax.i18n.errors||"errors")),i.length>0&&(r+="\n\n"+i.join(", ")),a.data.error_details&&a.data.error_details.length>0&&(r+="\n\n"+(mt_ajax.i18n.error_details||"Error details:"),a.data.error_details.slice(0,5).forEach(function(e){r+="\n- Row "+e.row+" ("+e.name+"): "+e.error}),a.data.error_details.length>5&&(r+="\n... and "+(a.data.error_details.length-5)+" more errors"))}alert(r),window.location.reload()}else{e(".mt-import-overlay").remove(),s.prop("disabled",!1).text(d);var o=mt_ajax.i18n.import_failed||"Import failed!";a.data&&a.data.message&&(o+="\n\n"+a.data.message),alert(o)}t.remove()},error:function(a,r,i){e(".mt-import-overlay").remove(),s.prop("disabled",!1).text(d);var o=mt_ajax.i18n.import_error||"An error occurred during import.";if(a.responseJSON&&a.responseJSON.data&&a.responseJSON.data.message)o+="\n\n"+a.responseJSON.data.message;else if(a.responseText)try{var n=JSON.parse(a.responseText);n.data&&n.data.message&&(o+="\n\n"+n.data.message)}catch(e){o+="\n\nStatus: "+r+"\nError: "+i}else o+="\n\nStatus: "+r+"\nError: "+i;alert(o),t.remove()}})}else t.remove()}),t.trigger("click")}else alert(mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n.import_not_initialized?mt_ajax.i18n.import_not_initialized:"Import functionality is not properly initialized. Please refresh the page and try again.")});var a=e("#mt-import-drop-zone");a.length&&(a.on("dragenter dragover",function(a){a.preventDefault(),a.stopPropagation(),e(this).addClass("drag-over")}),a.on("dragleave",function(a){a.preventDefault(),a.stopPropagation(),e(this).removeClass("drag-over")}),a.on("drop",function(a){a.preventDefault(),a.stopPropagation(),e(this).removeClass("drag-over");var t=a.originalEvent.dataTransfer.files;if(t.length>0){var r=t[0],i=r.name.toLowerCase();if(!i.endsWith(".csv")){var o=i.split(".").pop();return void("xlsx"===o||"xls"===o?alert(mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n.excel_to_csv_message?mt_ajax.i18n.excel_to_csv_message:'Please convert your Excel file to CSV format first. Use "Save As" in Excel and choose "CSV (Comma delimited)" as the file type.'):alert(mt_ajax.i18n.invalid_file_type||"Please select a CSV file."))}}})),e(document).on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),e(document).on("drop",function(e){e.preventDefault(),e.stopPropagation()})});
//# sourceMappingURL=candidate-import.js.map