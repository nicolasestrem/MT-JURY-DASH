(a=>{window.MT_I18n_Admin={init:function(){this.bindEvents(),this.initLanguageSelector(),this.updateStrings()},bindEvents:function(){a(document).on("change","#mt_language_preference",this.handleLanguageChange.bind(this)),a(document).on("click",".mt-language-switcher a",this.handleQuickSwitch.bind(this)),a(document).on("change","#mt_default_language",this.handleDefaultLanguageChange.bind(this))},initLanguageSelector:function(){a("#mt_language_preference, #mt_default_language").each(function(){var n,t=a(this);t.hasClass("enhanced")||(t.addClass("enhanced"),t.on("change",n=function(){var n=t.find("option:selected").text().split(" ")[0],e=t.siblings(".mt-language-preview");e.length||(e=a('<span class="mt-language-preview"></span>'),t.after(e)),e.html('<span class="mt-flag">'+n+"</span>")}),n())})},handleLanguageChange:function(n){var e=a(n.target),n=e.val();e.prop("disabled",!0),e.after('<span class="spinner is-active mt-spinner"></span>'),a.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_update_language_preference",language:n,nonce:mt_admin.nonce},success:function(n){n.success?(MT_I18n_Admin.showNotice(mt_admin.i18n.language_updated||"Language preference updated successfully.","success"),n.data.reload&&setTimeout(function(){window.location.reload()},1e3)):MT_I18n_Admin.showNotice(n.data||mt_admin.i18n.error||"An error occurred.","error")},error:function(){MT_I18n_Admin.showNotice(mt_admin.i18n.error||"An error occurred.","error")},complete:function(){e.prop("disabled",!1),a(".mt-spinner").remove()}})},handleQuickSwitch:function(n){n.preventDefault();var n=a(n.currentTarget),e=n.attr("href");n.addClass("mt-loading"),window.location.href=e},handleDefaultLanguageChange:function(n){var n=a(n.target),e=n.val(),t=n.data("current");t&&t!==e&&!confirm(mt_admin.i18n.confirm_default_language||"Are you sure you want to change the default language? This will affect all users who haven't set a preference.")?n.val(t):n.data("current",e)},updateStrings:function(){a(".mt-translatable").each(function(){var n=a(this),e=n.data("i18n-key");e&&mt_admin.i18n[e]&&n.text(mt_admin.i18n[e])}),a(".mt-tooltip").each(function(){var n=a(this),e=n.data("i18n-tooltip");e&&mt_admin.i18n[e]&&n.attr("title",mt_admin.i18n[e])}),a("[data-i18n-placeholder]").each(function(){var n=a(this),e=n.data("i18n-placeholder");e&&mt_admin.i18n[e]&&n.attr("placeholder",mt_admin.i18n[e])})},showNotice:function(n,e){var t=a('<div class="notice notice-'+(e=e||"info")+' is-dismissible mt-notice"><p>'+n+"</p></div>"),e=a(".mt-notices-container");e.length||(e=a('<div class="mt-notices-container"></div>'),a(".wrap h1").first().after(e)),e.append(t),setTimeout(function(){t.fadeOut(function(){t.remove()})},5e3),t.on("click",".notice-dismiss",function(){t.fadeOut(function(){t.remove()})})},getString:function(n,e){return mt_admin.i18n&&mt_admin.i18n[n]?mt_admin.i18n[n]:e||n},formatString:function(n,t){var a=this.getString(n);return t&&"object"==typeof t&&Object.keys(t).forEach(function(n){var e=new RegExp("%"+n+"%","g");a=a.replace(e,t[n])}),a}},a(document).ready(function(){MT_I18n_Admin.init()}),a("head").append(`
        <style>
        .mt-language-preview {
            display: inline-block;
            margin-left: 10px;
            font-size: 20px;
            vertical-align: middle;
        }
        .mt-spinner {
            margin-left: 10px;
            float: none;
            vertical-align: middle;
        }
        .mt-loading {
            opacity: 0.6;
            pointer-events: none;
        }
        .mt-notices-container {
            margin-top: 20px;
        }
        .mt-notice {
            margin: 5px 0;
        }
        #mt_language_preference,
        #mt_default_language {
            min-width: 200px;
        }
        .mt-language-switcher {
            margin-top: 10px;
        }
        .mt-flag {
            font-size: 1.2em;
            margin-right: 5px;
        }
        /* Admin bar language switcher styles */
        #wpadminbar .mt-language-switcher > a {
            padding: 0 8px !important;
        }
        #wpadminbar .mt-language-switcher .ab-submenu {
            min-width: 180px;
        }
        #wpadminbar .mt-language-switcher .ab-submenu a {
            padding: 0 16px !important;
            line-height: 32px !important;
        }
        </style>
    `)})(jQuery);