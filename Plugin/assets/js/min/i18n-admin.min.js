!function(n){"use strict";window.MT_I18n_Admin={init:function(){this.bindEvents(),this.initLanguageSelector(),this.updateStrings()},bindEvents:function(){n(document).on("change","#mt_language_preference",this.handleLanguageChange.bind(this)),n(document).on("click",".mt-language-switcher a",this.handleQuickSwitch.bind(this)),n(document).on("change","#mt_default_language",this.handleDefaultLanguageChange.bind(this))},initLanguageSelector:function(){n("#mt_language_preference, #mt_default_language").each(function(){var e=n(this);if(!e.hasClass("enhanced")){e.addClass("enhanced");var t=function(){var t=e.find("option:selected").text().split(" ")[0],a=e.siblings(".mt-language-preview");a.length||(a=n('<span class="mt-language-preview"></span>'),e.after(a)),a.html('<span class="mt-flag">'+t+"</span>")};e.on("change",t),t()}})},handleLanguageChange:function(e){var t=n(e.target),a=t.val();t.prop("disabled",!0),t.after('<span class="spinner is-active mt-spinner"></span>'),n.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_update_language_preference",language:a,nonce:mt_admin.nonce},success:function(n){n.success?(MT_I18n_Admin.showNotice(mt_admin.i18n.language_updated||"Language preference updated successfully.","success"),n.data.reload&&setTimeout(function(){window.location.reload()},1e3)):MT_I18n_Admin.showNotice(n.data||mt_admin.i18n.error||"An error occurred.","error")},error:function(){MT_I18n_Admin.showNotice(mt_admin.i18n.error||"An error occurred.","error")},complete:function(){t.prop("disabled",!1),n(".mt-spinner").remove()}})},handleQuickSwitch:function(e){e.preventDefault();var t=n(e.currentTarget),a=t.attr("href");t.addClass("mt-loading"),window.location.href=a},handleDefaultLanguageChange:function(e){var t=n(e.target),a=t.val(),i=t.data("current");!i||i===a||confirm(mt_admin.i18n.confirm_default_language||"Are you sure you want to change the default language? This will affect all users who haven't set a preference.")?t.data("current",a):t.val(i)},updateStrings:function(){n(".mt-translatable").each(function(){var e=n(this),t=e.data("i18n-key");t&&mt_admin.i18n[t]&&e.text(mt_admin.i18n[t])}),n(".mt-tooltip").each(function(){var e=n(this),t=e.data("i18n-tooltip");t&&mt_admin.i18n[t]&&e.attr("title",mt_admin.i18n[t])}),n("[data-i18n-placeholder]").each(function(){var e=n(this),t=e.data("i18n-placeholder");t&&mt_admin.i18n[t]&&e.attr("placeholder",mt_admin.i18n[t])})},showNotice:function(e,t){var a=n('<div class="notice notice-'+(t=t||"info")+' is-dismissible mt-notice"><p>'+e+"</p></div>"),i=n(".mt-notices-container");i.length||(i=n('<div class="mt-notices-container"></div>'),n(".wrap h1").first().after(i)),i.append(a),setTimeout(function(){a.fadeOut(function(){a.remove()})},5e3),a.on("click",".notice-dismiss",function(){a.fadeOut(function(){a.remove()})})},getString:function(n,e){return mt_admin.i18n&&mt_admin.i18n[n]?mt_admin.i18n[n]:e||n},formatString:function(n,e){var t=this.getString(n);return e&&"object"==typeof e&&Object.keys(e).forEach(function(n){var a=new RegExp("%"+n+"%","g");t=t.replace(a,e[n])}),t}},n(document).ready(function(){MT_I18n_Admin.init()});n("head").append("\n        <style>\n        .mt-language-preview {\n            display: inline-block;\n            margin-left: 10px;\n            font-size: 20px;\n            vertical-align: middle;\n        }\n        .mt-spinner {\n            margin-left: 10px;\n            float: none;\n            vertical-align: middle;\n        }\n        .mt-loading {\n            opacity: 0.6;\n            pointer-events: none;\n        }\n        .mt-notices-container {\n            margin-top: 20px;\n        }\n        .mt-notice {\n            margin: 5px 0;\n        }\n        #mt_language_preference,\n        #mt_default_language {\n            min-width: 200px;\n        }\n        .mt-language-switcher {\n            margin-top: 10px;\n        }\n        .mt-flag {\n            font-size: 1.2em;\n            margin-right: 5px;\n        }\n        /* Admin bar language switcher styles */\n        #wpadminbar .mt-language-switcher > a {\n            padding: 0 8px !important;\n        }\n        #wpadminbar .mt-language-switcher .ab-submenu {\n            min-width: 180px;\n        }\n        #wpadminbar .mt-language-switcher .ab-submenu a {\n            padding: 0 16px !important;\n            line-height: 32px !important;\n        }\n        </style>\n    ")}(jQuery);
//# sourceMappingURL=i18n-admin.js.map