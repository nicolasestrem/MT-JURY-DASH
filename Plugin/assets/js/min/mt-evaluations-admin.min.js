!function(t){"use strict";window.MTEvaluations={init:function(){this.bindEvents(),this.setupBulkActions()},bindEvents:function(){var a=this;t(document).on("click",".view-details",function(n){n.preventDefault();var e=t(this).data("evaluation-id");a.showDetails(e)}),t(document).on("click",".mt-delete-evaluation",function(n){n.preventDefault();var e=t(this).data("id");confirm(mt_evaluations_i18n.confirm_delete||"Are you sure you want to delete this evaluation?")&&a.deleteEvaluation(e)}),t(document).on("click",".mt-modal-close, .mt-modal-overlay",function(n){(t(n.target).hasClass("mt-modal-close")||t(n.target).hasClass("mt-modal-overlay"))&&a.closeModal()}),t(document).on("keydown",function(n){27===n.keyCode&&t("#mt-evaluation-modal").length&&a.closeModal()})},setupBulkActions:function(){var a=this;t("#doaction, #doaction2").on("click",function(n){var e=t(this).prev("select").val();if("-1"!==e){n.preventDefault();var o=[];t('input[name="evaluation[]"]:checked').each(function(){o.push(t(this).val())}),0!==o.length?("delete"!==e||confirm(mt_evaluations_i18n.confirm_bulk_delete||"Are you sure you want to delete the selected evaluations?"))&&a.bulkAction(e,o):alert(mt_evaluations_i18n.no_selection||"Please select at least one evaluation.")}}),t("#cb-select-all-1, #cb-select-all-2").on("change",function(){var a=t(this).prop("checked");t('input[name="evaluation[]"]').prop("checked",a),t("#cb-select-all-1, #cb-select-all-2").prop("checked",a)})},showDetails:function(a){var n=this;n.showLoading(),t.ajax({url:ajaxurl,type:"POST",data:{action:"mt_get_evaluation_details",evaluation_id:a,nonce:mt_evaluations_vars.nonce||t("#_wpnonce").val()},success:function(t){t.success&&t.data?n.displayModal(t.data):(n.closeModal(),alert(t.data||"Failed to load evaluation details."))},error:function(){n.closeModal(),alert("Error loading evaluation details.")}})},displayModal:function(a){t("#mt-evaluation-modal-wrapper").remove();var n="";a.scores&&t.each(a.scores,function(t,a){var e=a.value/10*100;n+=`\n                        <div class="mt-score-row">\n                            <div class="mt-score-label">${a.label}</div>\n                            <div class="mt-score-bar">\n                                <div class="mt-score-fill" style="width: ${e}%"></div>\n                            </div>\n                            <div class="mt-score-value">${a.value.toFixed(1)}</div>\n                        </div>\n                    `});var e=`\n                <div id="mt-evaluation-modal-wrapper" class="mt-modal-wrapper">\n                    <div class="mt-modal-overlay"></div>\n                    <div id="mt-evaluation-modal" class="mt-modal">\n                        <div class="mt-modal-header">\n                            <h2>${mt_evaluations_i18n.evaluation_details||"Evaluation Details"} #${a.id}</h2>\n                            <button type="button" class="mt-modal-close" aria-label="Close">\n                                <span aria-hidden="true">&times;</span>\n                            </button>\n                        </div>\n                        <div class="mt-modal-body">\n                            <div class="mt-evaluation-info">\n                                <table class="widefat striped">\n                                    <tbody>\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.jury_member||"Jury Member"}:</th>\n                                            <td>${a.jury_member}</td>\n                                        </tr>\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.candidate||"Candidate"}:</th>\n                                            <td>${a.candidate}</td>\n                                        </tr>\n                                        ${a.organization?`\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.organization||"Organization"}:</th>\n                                            <td>${a.organization}</td>\n                                        </tr>`:""}\n                                        ${a.categories?`\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.categories||"Categories"}:</th>\n                                            <td>${a.categories}</td>\n                                        </tr>`:""}\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.status||"Status"}:</th>\n                                            <td><span class="mt-status mt-status-${a.status}">${a.status}</span></td>\n                                        </tr>\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.created||"Created"}:</th>\n                                            <td>${a.created_at}</td>\n                                        </tr>\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.updated||"Last Updated"}:</th>\n                                            <td>${a.updated_at}</td>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                            </div>\n                            \n                            <div class="mt-evaluation-scores">\n                                <h3>${mt_evaluations_i18n.scores||"Evaluation Scores"}</h3>\n                                ${n}\n                                <div class="mt-score-summary">\n                                    <div class="mt-total-score">\n                                        <strong>${mt_evaluations_i18n.total_score||"Total Score"}:</strong>\n                                        <span class="mt-score-total">${a.total_score.toFixed(1)} / 50</span>\n                                    </div>\n                                    <div class="mt-average-score">\n                                        <strong>${mt_evaluations_i18n.average_score||"Average"}:</strong>\n                                        <span class="mt-score-average">${a.average_score.toFixed(2)}</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            ${a.comments?`\n                            <div class="mt-evaluation-comments">\n                                <h3>${mt_evaluations_i18n.comments||"Comments"}</h3>\n                                <div class="mt-comments-text">${a.comments}</div>\n                            </div>`:""}\n                        </div>\n                        <div class="mt-modal-footer">\n                            <button type="button" class="button button-primary mt-modal-close">\n                                ${mt_evaluations_i18n.close||"Close"}\n                            </button>\n                            <button type="button" class="button button-link-delete mt-delete-evaluation" data-id="${a.id}">\n                                ${mt_evaluations_i18n.delete||"Delete Evaluation"}\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            `;t("body").append(e),t(document).trigger("mt:evaluation:modal:opened",[a])},showLoading:function(){var a=`\n                <div id="mt-evaluation-modal-wrapper" class="mt-modal-wrapper">\n                    <div class="mt-modal-overlay"></div>\n                    <div class="mt-modal-loading">\n                        <div class="spinner is-active"></div>\n                        <p>${mt_evaluations_i18n.loading||"Loading..."}</p>\n                    </div>\n                </div>\n            `;t("body").append(a)},closeModal:function(){t("#mt-evaluation-modal-wrapper").fadeOut(200,function(){t(this).remove()}),t(document).trigger("mt:evaluation:modal:closed")},deleteEvaluation:function(a){var n=this;t.ajax({url:ajaxurl,type:"POST",data:{action:"mt_delete_evaluation",evaluation_id:a,nonce:mt_evaluations_vars.nonce||t("#_wpnonce").val()},success:function(e){e.success?(n.closeModal(),t('input[value="'+a+'"][name="evaluation[]"]').closest("tr").fadeOut(400,function(){t(this).remove(),0===t('input[name="evaluation[]"]').length&&location.reload()}),n.showNotice(e.data.message||"Evaluation deleted successfully","success")):alert(e.data||"Failed to delete evaluation")},error:function(){alert("Error deleting evaluation")}})},bulkAction:function(a,n){t.ajax({url:ajaxurl,type:"POST",data:{action:"mt_bulk_evaluation_action",bulk_action:a,evaluation_ids:n,nonce:mt_evaluations_vars.nonce||t("#_wpnonce").val()},success:function(t){t.success?location.reload():alert(t.data||"Failed to perform bulk action")},error:function(){alert("Error performing bulk action")}})},showNotice:function(a,n){var e=`\n                <div class="notice notice-${n} is-dismissible mt-admin-notice">\n                    <p>${a}</p>\n                    <button type="button" class="notice-dismiss">\n                        <span class="screen-reader-text">Dismiss this notice.</span>\n                    </button>\n                </div>\n            `;t(".mt-admin-notice").remove(),t(".wrap > h1").after(e),setTimeout(function(){t(".mt-admin-notice").fadeOut(400,function(){t(this).remove()})},5e3),t(".mt-admin-notice .notice-dismiss").on("click",function(){t(this).closest(".notice").fadeOut(400,function(){t(this).remove()})})}},t(document).ready(function(){(t(".view-details[data-evaluation-id]").length>0||window.location.href.includes("page=mt-evaluations"))&&MTEvaluations.init()})}(jQuery);
//# sourceMappingURL=mt-evaluations-admin.js.map