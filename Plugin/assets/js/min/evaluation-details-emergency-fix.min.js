jQuery(document).ready(function(s){var r=window.mt_eval_details_i18n||{};function t(){s(".view-details").off("click.mtDetails"),s(".view-details").on("click.mtDetails",function(t){t.preventDefault(),t.stopPropagation();var e,a,o,n,i,l,t=s(this),d=t.data("evaluation-id");d&&(e=(t=t.closest("tr")).find("td:eq(2)").text().trim(),a=t.find("td:eq(3)").text().trim(),o=t.find("td:eq(4)").text().trim(),n=t.find("td:eq(5)").text().trim(),i=t.find("td:eq(6)").text().trim(),l=t.find("td:eq(2) a").attr("href")||"#",t=t.find("td:eq(3) a").attr("href")||"#",l=`
                <div id="mt-evaluation-modal-overlay" class="mt-modal-overlay">
                    <div id="mt-evaluation-modal" class="mt-modal">
                        <div class="mt-modal-header">
                            <h2>${r&&r.modal?r.modal.title:"Evaluation Details"} #${d}</h2>
                            <button class="mt-modal-close" aria-label="Close">&times;</button>
                        </div>
                        <div class="mt-modal-body">
                            <table class="widefat striped">
                                <tbody>
                                    <tr>
                                        <th style="width: 30%;">Jury Member:</th>
                                        <td>${"#"!==l?`<a href="${l}" target="_blank">${e}</a>`:e}</td>
                                    </tr>
                                    <tr>
                                        <th>Candidate:</th>
                                        <td>${"#"!==t?`<a href="${t}" target="_blank">${a}</a>`:a}</td>
                                    </tr>
                                    <tr>
                                        <th>Total Score:</th>
                                        <td><strong>${o}</strong></td>
                                    </tr>
                                    <tr>
                                        <th>Status:</th>
                                        <td><span class="status-${n.toLowerCase()}">${n}</span></td>
                                    </tr>
                                    <tr>
                                        <th>Last Updated:</th>
                                        <td>${i}</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <div class="mt-modal-notice">
                                <p><strong>${r&&r.modal?r.modal.note:"Note"}:</strong> ${r&&r.modal?r.modal.temp_message:"Full evaluation details with individual criteria scores would normally appear here. This is a temporary fix while the full AJAX functionality is being restored."}</p>
                            </div>
                        </div>
                        <div class="mt-modal-footer">
                            <button class="button button-primary mt-modal-close">${r&&r.modal?r.modal.close:"Close"}</button>
                            ${"#"!==t?`<a href="${t}" class="button" target="_blank">${r&&r.modal?r.modal.view_candidate:"View Candidate"}</a>`:""}
                            <button class="button button-link-delete mt-delete-evaluation" data-id="${d}">${r&&r.modal?r.modal.delete:"Delete Evaluation"}</button>
                        </div>
                    </div>
                </div>
            `,s("#mt-evaluation-modal-styles").length||s("head").append(`
                    <style id="mt-evaluation-modal-styles">
                        .mt-modal-overlay {
                            position: fixed;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            background: rgba(0, 0, 0, 0.7);
                            z-index: 159900;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            animation: mtFadeIn 0.3s ease;
                        }
                        
                        .mt-modal {
                            background: #fff;
                            max-width: 600px;
                            width: 90%;
                            max-height: 80vh;
                            overflow: auto;
                            border-radius: 4px;
                            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
                            animation: mtSlideIn 0.3s ease;
                        }
                        
                        .mt-modal-header {
                            padding: 15px 20px;
                            border-bottom: 1px solid #ddd;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                        }
                        
                        .mt-modal-header h2 {
                            margin: 0;
                            font-size: 1.3em;
                        }
                        
                        .mt-modal-close {
                            background: none;
                            border: none;
                            font-size: 24px;
                            cursor: pointer;
                            color: #666;
                            padding: 0;
                            width: 30px;
                            height: 30px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                        }
                        
                        .mt-modal-close:hover {
                            color: #000;
                        }
                        
                        .mt-modal-body {
                            padding: 20px;
                        }
                        
                        .mt-modal-body table {
                            margin-bottom: 20px;
                        }
                        
                        .mt-modal-notice {
                            background: #f0f0f1;
                            border-left: 4px solid #72aee6;
                            padding: 12px;
                            margin: 15px 0;
                        }
                        
                        .mt-modal-notice p {
                            margin: 0;
                        }
                        
                        .mt-modal-footer {
                            padding: 15px 20px;
                            border-top: 1px solid #ddd;
                            background: #f9f9f9;
                            display: flex;
                            gap: 10px;
                            justify-content: flex-end;
                        }
                        
                        .status-completed,
                        .status-submitted {
                            color: #46b450;
                            font-weight: 600;
                        }
                        
                        .status-draft {
                            color: #ffb900;
                            font-weight: 600;
                        }
                        
                        .status-rejected {
                            color: #dc3232;
                            font-weight: 600;
                        }
                        
                        @keyframes mtFadeIn {
                            from { opacity: 0; }
                            to { opacity: 1; }
                        }
                        
                        @keyframes mtSlideIn {
                            from { 
                                transform: translateY(-20px);
                                opacity: 0;
                            }
                            to { 
                                transform: translateY(0);
                                opacity: 1;
                            }
                        }
                    </style>
                `),s("#mt-evaluation-modal-overlay").remove(),s("body").append(l),s(".mt-modal-close, #mt-evaluation-modal-overlay").on("click",function(t){t.target!==this&&!s(this).hasClass("mt-modal-close")||s("#mt-evaluation-modal-overlay").fadeOut(200,function(){s(this).remove()})}),s(".mt-delete-evaluation").on("click",function(){var t=s(this).data("id"),e=r&&r.confirmations?r.confirmations.delete_single:"Are you sure you want to delete this evaluation? This action cannot be undone.";confirm(e)&&(e="",window.MTEvaluations&&window.MTEvaluations.nonce?e=window.MTEvaluations.nonce:s("#_wpnonce").length&&(e=s("#_wpnonce").val()),e?window.location.href=`admin.php?page=mt-evaluations&action=delete&id=${t}&_wpnonce=`+e:(t=r&&r.errors?r.errors.token_missing:"Security token not found. Please refresh the page and try again.",alert(t)))}),s(document).on("keydown.mtModal",function(t){27===t.keyCode&&(s("#mt-evaluation-modal-overlay").fadeOut(200,function(){s(this).remove()}),s(document).off("keydown.mtModal"))}))})}function e(){s("#doaction, #doaction2").off("click.mtBulk").on("click.mtBulk",function(t){var e,a;if("delete"===s(this).prev("select").val())return e=[],s('input[name="evaluation[]"]:checked').each(function(){e.push(s(this).val())}),0===e.length?(a=r&&r.confirmations?r.confirmations.select_evaluation:"Please select at least one evaluation to delete.",alert(a),t.preventDefault(),!1):(a=r&&r.confirmations&&r.confirmations.delete_multiple?r.confirmations.delete_multiple.replace("%s",e.length):`Are you sure you want to delete ${e.length} evaluation(s)? This action cannot be undone.`,confirm(a)?(a="",window.MTEvaluations&&window.MTEvaluations.nonce?a=window.MTEvaluations.nonce:s("#_wpnonce").length&&(a=s("#_wpnonce").val()),a?(a=s(`
                    <form method="post" action="admin.php?page=mt-evaluations">
                        <input type="hidden" name="action" value="bulk_delete">
                        <input type="hidden" name="evaluations" value="${e.join(",")}">
                        <input type="hidden" name="_wpnonce" value="${a}">
                    </form>
                `),s("body").append(a),void a.submit()):(alert("Security token not found. Please refresh the page and try again."),t.preventDefault(),!1)):(t.preventDefault(),!1))})}(s("body").hasClass("toplevel_page_mt-evaluations")||window.location.href.includes("page=mt-evaluations")||s(".view-details[data-evaluation-id]").length)&&(t(),e(),s(document).on("ajaxComplete",function(){setTimeout(function(){s(".view-details").length&&(t(),e())},100)}))});