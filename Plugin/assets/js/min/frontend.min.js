(i=>{"undefined"==typeof mt_ajax&&(window.mt_ajax={ajax_url:"/wp-admin/admin-ajax.php",nonce:"",i18n:{error:"An error occurred",success:"Success",loading:"Loading...",confirm:"Are you sure?"}}),mt_ajax.ajax_url||(mt_ajax.ajax_url="/wp-admin/admin-ajax.php"),mt_ajax.i18n||(mt_ajax.i18n={}),window.getI18nText=function(a,t){var e;return"undefined"!=typeof mt_frontend_i18n&&mt_frontend_i18n&&mt_frontend_i18n.ui&&mt_frontend_i18n.ui[a]?mt_frontend_i18n.ui[a]:"undefined"!=typeof mt_ajax&&mt_ajax&&mt_ajax.i18n&&mt_ajax.i18n[a]?mt_ajax.i18n[a]:"undefined"!=typeof mt_frontend&&mt_frontend&&mt_frontend.i18n&&mt_frontend.i18n[a]?mt_frontend.i18n[a]:(e={evaluation_submitted_full:"evaluation_submitted"})[a]?window.getI18nText(e[a],t):t||""};var a,o=window.getI18nText,c=(window.addEventListener("error",function(a){window.MTErrorHandler&&MTErrorHandler.logError("JavaScript Error",{message:a.message,filename:a.filename,lineno:a.lineno,colno:a.colno,stack:a.error?a.error.stack:"No stack trace available"})}),window.mtIntervals=window.mtIntervals||{},window.mtTimeouts=window.mtTimeouts||{},window.mtEventListeners=window.mtEventListeners||[],window.mtCleanup=function(){if(window.mtIntervals)for(var a in window.mtIntervals)window.mtIntervals.hasOwnProperty(a)&&(clearInterval(window.mtIntervals[a]),window.mtIntervals[a]=null);if(window.mtEventListeners&&0<window.mtEventListeners.length&&(window.mtEventListeners.forEach(function(a){a.element&&a.element.removeEventListener&&a.element.removeEventListener(a.event,a.handler)}),window.mtEventListeners=[]),"undefined"!=typeof jQuery&&(jQuery("*").stop(!0,!0),jQuery(".mt-tooltip").remove(),jQuery(".mt-alert").remove()),window.mtTimeouts)for(var t in window.mtTimeouts)window.mtTimeouts.hasOwnProperty(t)&&(clearTimeout(window.mtTimeouts[t]),window.mtTimeouts[t]=null)},window.addEventListener("beforeunload",function(){window.mtCleanup()}),document.addEventListener("visibilitychange",function(){if(document.hidden){if(window.mtIntervals)for(var a in window.mtPausedIntervals={},window.mtIntervals)window.mtIntervals.hasOwnProperty(a)&&window.mtIntervals[a]&&(clearInterval(window.mtIntervals[a]),window.mtPausedIntervals[a]=!0)}else window.mtPausedIntervals&&(window.mtPausedIntervals.rankingsRefresh&&(window.mtIntervals.rankingsRefresh=setInterval(function(){"undefined"!=typeof jQuery&&0<jQuery("#mt-rankings-container").length&&jQuery.ajax({url:mt_ajax.ajax_url,type:"POST",data:{action:"mt_get_jury_rankings",nonce:mt_ajax.nonce,limit:10},success:function(a){a.success&&a.data.html&&(jQuery("#mt-rankings-container").html(a.data.html),jQuery(".mt-ranking-item:visible").each(function(a){a<20&&jQuery(this).css("opacity","0").delay(50*a).animate({opacity:1},300)}))},error:function(){}})},6e4)),window.mtPausedIntervals.inlineRankingsRefresh&&0<jQuery(".mt-rankings-section").length&&(window.mtIntervals.inlineRankingsRefresh=setInterval(function(){"undefined"!=typeof jQuery&&0<jQuery(".mt-rankings-section").length&&0<jQuery("#mt-rankings-container").length&&jQuery.ajax({url:mt_ajax.ajax_url,type:"POST",data:{action:"mt_get_jury_rankings",nonce:mt_ajax.nonce,limit:10},success:function(a){a.success&&a.data.html&&jQuery("#mt-rankings-container").html(a.data.html)},error:function(){}})},3e4)),window.mtPausedIntervals={})}),window.location.href.includes("evaluate=")&&((a=document.referrer)&&(a.includes("action=edit")||a.includes("action=elementor"))?sessionStorage.getItem("mt_evaluation_refreshed")||(sessionStorage.setItem("mt_evaluation_refreshed","true"),window.location.reload(!0)):sessionStorage.removeItem("mt_evaluation_refreshed")),{init:function(){this.bindEvents(),this.initEvaluationForm(),this.updateTotalScore(),this.initCharacterCount()},bindEvents:function(){var t=this;function a(a,t,e){i(a).on(t,e),window.mtEventListeners&&window.mtEventListeners.push({element:document,event:t,selector:a,handler:e})}a("#mt-evaluation-form","submit",function(a){t.submitEvaluation.call(t,a)}),a(".mt-score-slider","input",function(){t.updateScoreDisplay.call(this)}),a(".mt-score-mark","click",function(a){t.setScoreFromMark.call(this,a)}),a(".mt-evaluate-btn","click",function(a){t.loadEvaluation.call(t,a)}),a("#mt-comments","input",function(){t.updateCharCount.call(this)})},initEvaluationForm:function(){var a=new URLSearchParams(window.location.search).get("evaluate");a&&this.loadEvaluationForm(a)},loadEvaluation:function(a){a.preventDefault();a=i(this).data("candidate-id");a?this.loadEvaluationForm(a):this.showError(o("invalid_candidate","Invalid candidate ID."))},loadEvaluationForm:function(e){var a,t,n=this;"undefined"!=typeof mt_ajax&&mt_ajax.nonce?(a=i(".mt-jury-dashboard"),t=o("loading_evaluation","Loading evaluation form..."),a.html('<div class="mt-loading">'+t+"</div>"),i.post(mt_ajax.ajax_url,{action:"mt_get_candidate_details",candidate_id:e,nonce:mt_ajax.nonce}).done(function(a){var t;a.success?(t=a.data.data||a.data,n.displayEvaluationForm(t),n.loadExistingEvaluation(e)):n.showError(a.data.message)}).fail(function(a,t,e){MTErrorHandler.handleAjaxError(a,t,e,"loadEvaluationForm - candidate details")})):(MTErrorHandler.logError("mt_ajax configuration missing",{mt_ajax_defined:"undefined"!=typeof mt_ajax,nonce_present:!(!mt_ajax||!mt_ajax.nonce)}),MTErrorHandler.showUserError(o("security_error","Security configuration error. Please refresh the page and try again.")))},displayEvaluationForm:function(a){a=`
                <div class="mt-evaluation-wrapper">
                    <div class="mt-candidate-details">
                        <h2>${a.name}</h2>
                        <p class="mt-candidate-org">${a.organization||""}</p>
                        ${a.photo_url?`<img src="${a.photo_url}" alt="${a.name}" class="mt-candidate-photo-eval">`:""}
                        <div class="mt-candidate-bio">${a.bio}</div>
                    </div>
                    <form id="mt-evaluation-form" class="mt-evaluation-form">
                        <input type="hidden" name="candidate_id" value="${a.id}">
                        <div class="mt-criteria-section">
                            <h3>${mt_frontend.i18n.evaluation_criteria||"Evaluation Criteria"}</h3>
                            <div class="mt-criterion-card" data-criterion="courage">
                                <div class="mt-criterion-header">
                                    <span class="mt-criterion-icon dashicons dashicons-superhero"></span>
                                    <h4 class="mt-criterion-label">${mt_frontend.i18n.mut_pioniergeist||"Mut & Pioniergeist"}</h4>
                                </div>
                                <p class="mt-criterion-description">${mt_frontend.i18n.mut_description||"Mut, Konventionen herauszufordern und neue Wege in der Mobilität zu beschreiten"}</p>
                                <div class="mt-score-slider-wrapper">
                                    <input type="range" name="courage_score" class="mt-score-slider" min="0" max="10" value="5">
                                    <div class="mt-score-marks">
                                        <span class="mt-score-mark" data-value="0">0</span>
                                        <span class="mt-score-mark" data-value="1">1</span>
                                        <span class="mt-score-mark" data-value="2">2</span>
                                        <span class="mt-score-mark" data-value="3">3</span>
                                        <span class="mt-score-mark" data-value="4">4</span>
                                        <span class="mt-score-mark" data-value="5">5</span>
                                        <span class="mt-score-mark" data-value="6">6</span>
                                        <span class="mt-score-mark" data-value="7">7</span>
                                        <span class="mt-score-mark" data-value="8">8</span>
                                        <span class="mt-score-mark" data-value="9">9</span>
                                        <span class="mt-score-mark" data-value="10">10</span>
                                    </div>
                                </div>
                                <div class="mt-score-display">
                                    <span class="mt-score-value">5</span>
                                </div>
                            </div>
                            <div class="mt-criterion-card" data-criterion="innovation">
                                <div class="mt-criterion-header">
                                    <span class="mt-criterion-icon dashicons dashicons-lightbulb"></span>
                                    <h4 class="mt-criterion-label">${mt_frontend.i18n.innovationsgrad||"Innovationsgrad"}</h4>
                                </div>
                                <p class="mt-criterion-description">${mt_frontend.i18n.innovation_description||"Grad an Innovation und Kreativität bei der Lösung von Mobilitätsherausforderungen"}</p>
                                <div class="mt-score-slider-wrapper">
                                    <input type="range" name="innovation_score" class="mt-score-slider" min="0" max="10" value="5">
                                    <div class="mt-score-marks">
                                        <span class="mt-score-mark" data-value="0">0</span>
                                        <span class="mt-score-mark" data-value="1">1</span>
                                        <span class="mt-score-mark" data-value="2">2</span>
                                        <span class="mt-score-mark" data-value="3">3</span>
                                        <span class="mt-score-mark" data-value="4">4</span>
                                        <span class="mt-score-mark" data-value="5">5</span>
                                        <span class="mt-score-mark" data-value="6">6</span>
                                        <span class="mt-score-mark" data-value="7">7</span>
                                        <span class="mt-score-mark" data-value="8">8</span>
                                        <span class="mt-score-mark" data-value="9">9</span>
                                        <span class="mt-score-mark" data-value="10">10</span>
                                    </div>
                                </div>
                                <div class="mt-score-display">
                                    <span class="mt-score-value">5</span>
                                </div>
                            </div>
                            <div class="mt-criterion-card" data-criterion="implementation">
                                <div class="mt-criterion-header">
                                    <span class="mt-criterion-icon dashicons dashicons-hammer"></span>
                                    <h4 class="mt-criterion-label">${mt_frontend.i18n.umsetzungskraft||"Umsetzungskraft & Wirkung"}</h4>
                                </div>
                                <p class="mt-criterion-description">${mt_frontend.i18n.umsetzung_description||"Fähigkeit zur Umsetzung und realer Einfluss der Initiativen"}</p>
                                <div class="mt-score-slider-wrapper">
                                    <input type="range" name="implementation_score" class="mt-score-slider" min="0" max="10" value="5">
                                    <div class="mt-score-marks">
                                        <span class="mt-score-mark" data-value="0">0</span>
                                        <span class="mt-score-mark" data-value="1">1</span>
                                        <span class="mt-score-mark" data-value="2">2</span>
                                        <span class="mt-score-mark" data-value="3">3</span>
                                        <span class="mt-score-mark" data-value="4">4</span>
                                        <span class="mt-score-mark" data-value="5">5</span>
                                        <span class="mt-score-mark" data-value="6">6</span>
                                        <span class="mt-score-mark" data-value="7">7</span>
                                        <span class="mt-score-mark" data-value="8">8</span>
                                        <span class="mt-score-mark" data-value="9">9</span>
                                        <span class="mt-score-mark" data-value="10">10</span>
                                    </div>
                                </div>
                                <div class="mt-score-display">
                                    <span class="mt-score-value">5</span>
                                </div>
                            </div>
                            <div class="mt-criterion-card" data-criterion="relevance">
                                <div class="mt-criterion-header">
                                    <span class="mt-criterion-icon dashicons dashicons-location-alt"></span>
                                    <h4 class="mt-criterion-label">${mt_frontend.i18n.relevanz||"Relevanz für die Mobilitätswende"}</h4>
                                </div>
                                <p class="mt-criterion-description">${mt_frontend.i18n.relevanz_description||"Bedeutung und Beitrag zur Transformation der Mobilität"}</p>
                                <div class="mt-score-slider-wrapper">
                                    <input type="range" name="relevance_score" class="mt-score-slider" min="0" max="10" value="5">
                                    <div class="mt-score-marks">
                                        <span class="mt-score-mark" data-value="0">0</span>
                                        <span class="mt-score-mark" data-value="1">1</span>
                                        <span class="mt-score-mark" data-value="2">2</span>
                                        <span class="mt-score-mark" data-value="3">3</span>
                                        <span class="mt-score-mark" data-value="4">4</span>
                                        <span class="mt-score-mark" data-value="5">5</span>
                                        <span class="mt-score-mark" data-value="6">6</span>
                                        <span class="mt-score-mark" data-value="7">7</span>
                                        <span class="mt-score-mark" data-value="8">8</span>
                                        <span class="mt-score-mark" data-value="9">9</span>
                                        <span class="mt-score-mark" data-value="10">10</span>
                                    </div>
                                </div>
                                <div class="mt-score-display">
                                    <span class="mt-score-value">5</span>
                                </div>
                            </div>
                            <div class="mt-criterion-card" data-criterion="visibility">
                                <div class="mt-criterion-header">
                                    <span class="mt-criterion-icon dashicons dashicons-visibility"></span>
                                    <h4 class="mt-criterion-label">${mt_frontend.i18n.vorbildfunktion||"Vorbildfunktion & Sichtbarkeit"}</h4>
                                </div>
                                <p class="mt-criterion-description">${mt_frontend.i18n.vorbild_description||"Rolle als Vorbild und öffentliche Wahrnehmbarkeit im Mobilitätssektor"}</p>
                                <div class="mt-score-slider-wrapper">
                                    <input type="range" name="visibility_score" class="mt-score-slider" min="0" max="10" value="5">
                                    <div class="mt-score-marks">
                                        <span class="mt-score-mark" data-value="0">0</span>
                                        <span class="mt-score-mark" data-value="1">1</span>
                                        <span class="mt-score-mark" data-value="2">2</span>
                                        <span class="mt-score-mark" data-value="3">3</span>
                                        <span class="mt-score-mark" data-value="4">4</span>
                                        <span class="mt-score-mark" data-value="5">5</span>
                                        <span class="mt-score-mark" data-value="6">6</span>
                                        <span class="mt-score-mark" data-value="7">7</span>
                                        <span class="mt-score-mark" data-value="8">8</span>
                                        <span class="mt-score-mark" data-value="9">9</span>
                                        <span class="mt-score-mark" data-value="10">10</span>
                                    </div>
                                </div>
                                <div class="mt-score-display">
                                    <span class="mt-score-value">5</span>
                                </div>
                            </div>
                        </div>
                        <div class="mt-comments-section">
                            <label for="mt-comments" class="mt-comments-label">${o("additional_comments","Additional Comments (Optional)")}</label>
                            <textarea name="comments" id="mt-comments" class="mt-comments-textarea" rows="5"></textarea>
                            <div class="mt-char-count">
                                <span id="mt-char-current">0</span> / 1000 ${o("characters","characters")}
                            </div>
                        </div>
                        <div class="mt-form-actions">
                            <button type="submit" class="mt-btn mt-btn-primary">${o("submit_evaluation","Submit Evaluation")}</button>
                            <a href="${window.location.pathname}" class="mt-btn mt-btn-secondary">${o("back_to_dashboard","Back to Dashboard")}</a>
                        </div>
                    </form>
                </div>
            `;i(".mt-jury-dashboard").html(a)},loadExistingEvaluation:function(a){"undefined"!=typeof mt_ajax&&mt_ajax.nonce?i.post(mt_ajax.ajax_url,{action:"mt_get_evaluation",candidate_id:a,nonce:mt_ajax.nonce}).done(function(a){a.success&&a.data.exists&&(a=a.data.evaluation,i('input[name="courage_score"]').val(a.courage_score).trigger("input"),i('input[name="innovation_score"]').val(a.innovation_score).trigger("input"),i('input[name="implementation_score"]').val(a.implementation_score).trigger("input"),i('input[name="relevance_score"]').val(a.relevance_score).trigger("input"),i('input[name="visibility_score"]').val(a.visibility_score).trigger("input"),i('textarea[name="comments"]').val(a.comments),"completed"===a.status)&&i(".mt-form-actions").prepend('<div class="mt-notice mt-notice-success">'+o("evaluation_submitted_editable","This evaluation has been submitted. You can still edit and resubmit.")+"</div>")}):c.showError(o("security_error","Security configuration error. Please refresh the page and try again."))},updateScoreDisplay:function(){var a=i(this),t=a.val(),t=(a.closest(".mt-criterion-card").find(".mt-score-value").text(t),t/10*100);a.css("background","linear-gradient(to right, #667eea 0%, #667eea "+t+"%, #e5e7eb "+t+"%, #e5e7eb 100%)"),c.updateTotalScore()},setScoreFromMark:function(a){a.preventDefault();var a=i(this),t=a.data("value");a.closest(".mt-criterion-card").find(".mt-score-slider").val(t).trigger("input")},updateTotalScore:function(){var t=0,e=0,n=0,a=i(".mt-score-slider"),a=((a=0===(a=0===(a=0===a.length?i('input[type="range"][name*="_score"]'):a).length?i('input[type="number"][name*="_score"]'):a).length?i('input[type="hidden"][name*="_score"]'):a).each(function(){var a=parseFloat(i(this).val());isNaN(a)||(t+=a,e++,0<a&&n++)}),0<e?(t/e).toFixed(1):"0.0"),s=i("#mt-total-score"),s=(s.length&&s.text(a),i(".mt-evaluated-count"));s.length&&(a="("+n+"/5 "+o("criteria_evaluated","criteria evaluated")+")",s.text(a))},updateCharCount:function(){var a=i(this),t=a.val().length;i("#mt-char-current").text(t),1e3<t&&(a.val(a.val().substring(0,1e3)),i("#mt-char-current").text(1e3))},initCharacterCount:function(){var a=i("#mt-comments");a.length&&i("#mt-char-current").text(a.val().length)},refreshCriteriaContent:function(a){var t;0<i(".mt-criteria-info-section").length&&((t=window.location.href).includes("?")?t+="&refresh="+Date.now():t+="?refresh="+Date.now(),window.location.href=t)},isSubmittingEvaluation:!(window.MTErrorHandler={logError:function(a,t){(new Date).toISOString(),window.location.href,navigator.userAgent;window.console&&console.error},showUserError:function(a,t){var e=i('<div class="mt-alert '+("warning"===(t=t||"error")?"mt-alert-warning":"mt-alert-error")+'"><span class="mt-alert-message">'+a+'</span><button class="mt-alert-close" type="button">&times;</button></div>');i(".mt-alert").remove(),i("body").prepend(e),window.mtTimeouts.alertAutoRemove&&clearTimeout(window.mtTimeouts.alertAutoRemove),window.mtTimeouts.alertAutoRemove=setTimeout(function(){e.fadeOut(function(){e.remove()}),delete window.mtTimeouts.alertAutoRemove},5e3),e.find(".mt-alert-close").on("click",function(){e.fadeOut(function(){e.remove()})})},handleAjaxError:function(a,t,e,n){var s=o("error","An error occurred. Please try again."),e={status:t,error:e,responseText:a.responseText,context:n||"Unknown"};try{a.responseJSON&&a.responseJSON.data&&a.responseJSON.data.message?s=a.responseJSON.data.message:a.responseJSON&&a.responseJSON.message?s=a.responseJSON.message:"timeout"===t?s=o("request_timeout","Request timed out. Please check your connection and try again."):"abort"===t?s=o("request_cancelled","Request was cancelled."):403===a.status?s=o("permission_denied","You do not have permission to perform this action."):404===a.status?s=o("resource_not_found","The requested resource was not found."):500<=a.status&&(s=o("server_error","Server error. Please try again later."))}catch(a){e.parseError=a.message}return this.logError("AJAX Error in "+n,e),this.showUserError(s),s}}),submitEvaluation:function(a){if(a.preventDefault(),this.isSubmittingEvaluation)return!1;var n,s,t,e,r;"undefined"!=typeof mt_ajax&&mt_ajax.nonce?(this.isSubmittingEvaluation=!0,n=this,a=i(a.target),s=a.find('button[type="submit"]'),t=!0,(r=0===(r=i(".mt-score-slider")).length?i('input[name*="_score"]'):r).each(function(){var a=parseFloat(i(this).val());if(isNaN(a)||a<0||10<a)return t=!1}),t?(r=o("submitting","Submitting..."),s.prop("disabled",!0).html('<span class="dashicons dashicons-update mt-spin"></span> '+r),e={},(r=0===(r=0===(r=i("#mt-evaluation-form")).length?i(".mt-evaluation-form"):r).length?a:r).find("input, textarea, select").each(function(){var a=i(this),t=a.attr("name"),a=a.val();t&&void 0!==a&&(e[t]=a)}),e.action="mt_submit_evaluation",e.nonce=mt_ajax.nonce,e.status="completed",i.post(mt_ajax.ajax_url,e).done(function(a){var t,e;a.success?(t=a.data&&a.data.message?a.data.message:o("evaluation_submitted","Thank you for submitting your evaluation!"),i(".mt-evaluation-header").after('<div class="mt-notice mt-notice-success">'+t+"</div>"),t=o("evaluation_submitted_status","Evaluation Submitted"),(e=i(".mt-evaluation-title .mt-status-badge")).length?e.removeClass("mt-status-draft").addClass("mt-status-completed").text(t):i(".mt-evaluation-title").append('<span class="mt-status-badge mt-status-completed">'+t+"</span>"),i("html, body").animate({scrollTop:0},300),s.prop("disabled",!1).html('<span class="dashicons dashicons-yes-alt"></span> '+o("submit_evaluation","Submit Evaluation")),window.mtTimeouts.evaluationRedirect&&clearTimeout(window.mtTimeouts.evaluationRedirect),window.mtTimeouts.evaluationRedirect=setTimeout(function(){window.location.href=window.location.pathname,delete window.mtTimeouts.evaluationRedirect},3e3)):(e=a.data&&a.data.message?a.data.message:o("error","An error occurred. Please try again."),c.showError(e),s.prop("disabled",!1).html('<span class="dashicons dashicons-yes-alt"></span> '+o("submit_evaluation","Submit Evaluation")),n.isSubmittingEvaluation=!1)}).fail(function(){c.showError(o("error","An error occurred. Please try again.")),s.prop("disabled",!1).html('<span class="dashicons dashicons-yes-alt"></span> '+o("submit_evaluation_btn",o("submit_evaluation","Submit Evaluation"))),n.isSubmittingEvaluation=!1})):c.showError(o("invalid_scores","Please ensure all scores are between 0 and 10."))):c.showError(o("security_error","Security configuration error. Please refresh the page and try again."))},showError:function(a){a='<div class="mt-notice mt-notice-error">'+a+"</div>";i(".mt-evaluation-form").before(a),i("html, body").animate({scrollTop:0},300)}});function n(a,t){a.find(".mt-star").each(function(){var a=i(this).data("value");i(this).toggleClass("filled",a<=t)})}function s(a,t){a.find(".mt-score-value").text(t)}i(document).ready(function(){c.init(),setTimeout(function(){c.updateTotalScore()},500),i(window).on("load",function(){c.updateTotalScore()})}),i(".mt-star-rating").length&&i(".mt-star-rating").each(function(){var t=i(this),e=t.find('input[type="hidden"]'),a=t.find(".mt-star");a.on("click",function(){var a=i(this).data("value");e.val(a).trigger("change"),n(t,a)}),a.on("mouseenter",function(){var a=i(this).data("value");n(t,a)}),t.on("mouseleave",function(){var a=e.val()||0;n(t,a)})}),i(document).on("click",".mt-star-rating .dashicons",function(){var a=i(this);let t=a.data("value");var e=a.parent();e.find(".dashicons").removeClass("active"),e.find(".dashicons").each(function(){i(this).data("value")<=t&&i(this).addClass("active")}),e.find('input[type="hidden"]').val(t),s(a.closest(".mt-criterion-card"),t)}),i(document).on("input",".mt-score-input",function(){var a=Math.min(10,Math.max(0,i(this).val()));i(this).val(a),s(i(this).closest(".mt-criterion-card"),a)}),jQuery(document).ready(function(t){function a(){"undefined"!=typeof mt_ajax&&mt_ajax.ajax_url&&mt_ajax.nonce&&t.ajax({url:mt_ajax.ajax_url,type:"POST",data:{action:"mt_get_jury_rankings",nonce:mt_ajax.nonce,limit:10},success:function(a){a.success&&a.data.html&&(t("#mt-rankings-container").html(a.data.html),t(".mt-ranking-item").each(function(a){t(this).css("opacity","0").delay(50*a).animate({opacity:1},300)}))}})}t(document).on("mt:evaluation:submitted",function(){a()});window.mtIntervals||(window.mtIntervals={}),window.mtIntervals.rankingsRefresh&&clearInterval(window.mtIntervals.rankingsRefresh),window.mtIntervals.rankingsRefresh=setInterval(a,6e4)}),jQuery(document).ready(function(e){e(".mt-rankings-section").length&&e(".mt-score-ring-progress").each(function(){let a=e(this),t=a.css("stroke-dashoffset");a.css("stroke-dashoffset","100"),setTimeout(()=>{a.css("stroke-dashoffset",t)},100)}),e(document).on("mouseenter",".mt-ranking-item",function(){e(this).find(".mt-score-ring-progress").css("stroke","#764ba2")}).on("mouseleave",function(){e(this).find(".mt-score-ring-progress").css("stroke","#667eea")}),e(document).on("click",".mt-ranking-item",function(){e(this).css("transform","scale(0.98)"),setTimeout(()=>{e(this).css("transform","")},150)})}),jQuery(document).ready(function(r){function n(){r(".mt-score-ring-mini").each(function(){var a=r(this).data("score");t(r(this),a)}),r(document).on("click",".mt-score-adjust",function(a){a.preventDefault();var a=r(this),t=a.siblings(".mt-score-input"),a=a.data("action"),e=parseFloat(t.val())||0;let n=e;"increase"===a&&e<10?n=Math.min(10,e+.5):"decrease"===a&&0<e&&(n=Math.max(0,e-.5)),t.val(n).trigger("change")}),r(document).on("change",".mt-score-input",function(){var a=r(this),e=parseFloat(a.val())||0,n=Math.max(0,Math.min(10,e)),e=(e!==n&&a.val(n),a.closest(".mt-criterion-inline").find(".mt-score-ring-mini"));t(e,n);{e=a.closest(".mt-ranking-item");let t=[];e.find(".mt-score-input").each(function(){var a=parseFloat(r(this).val());isNaN(a)||t.push(a)}),0<t.length&&(n=t.reduce((a,t)=>a+t,0)/t.length,(e=e.find(".mt-total-score-display .score-value")).text(n.toFixed(1)+"/10"),i(e,n))}}),r(document).on("click",".mt-btn-save-inline",function(a){a.preventDefault();let t=r(this);a=t.closest(".mt-inline-evaluation-form");let s=t.closest(".mt-ranking-item");var n=a.data("candidate-id");if(!t.hasClass("saving")){let e={};a.find(".mt-score-input").each(function(){var a=r(this).attr("name"),t=r(this).val();a&&t&&(e[a]=t)}),t.addClass("saving"),s.addClass("updating"),"undefined"!=typeof mt_ajax&&mt_ajax.nonce&&mt_ajax.ajax_url?(a={action:"mt_save_inline_evaluation",nonce:mt_ajax.nonce,candidate_id:n,scores:e},r.ajax({url:mt_ajax.ajax_url,type:"POST",data:a,dataType:"json",success:function(a){var t,e;a.success?(s.removeClass("updating").addClass("success"),t=a.data.total_score,(e=s.find(".mt-total-score-display .score-value")).text(t.toFixed(1)+"/10"),e.data("score",t),i(e,t),setTimeout(function(){o()},1500),setTimeout(function(){s.removeClass("success")},2e3)):(alert(a.data||"Error saving evaluation"),s.removeClass("updating"))},error:function(a,t,e){let n="Network error. Please try again.";try{a.responseJSON&&a.responseJSON.data&&(n=a.responseJSON.data)}catch(a){}alert(n),s.removeClass("updating")},complete:function(){t.removeClass("saving")}})):(alert("Configuration error. Please refresh the page and try again."),s.removeClass("updating"))}})}function t(a,t){var e=a.find(".mt-ring-progress");e.attr("stroke-dasharray",10*t+", 100"),a.attr("data-score",t),8<=t?e.css("stroke","#22c55e"):6<=t?e.css("stroke","#667eea"):4<=t?e.css("stroke","#f59e0b"):e.css("stroke","#ef4444")}function i(a,t){8<=t?a.css("color","#22c55e"):6<=t?a.css("color","#667eea"):4<=t?a.css("color","#f59e0b"):a.css("color","#ef4444")}function o(){if("undefined"!=typeof mt_ajax&&mt_ajax.ajax_url&&mt_ajax.nonce){let t=r("#mt-rankings-container");r.ajax({url:mt_ajax.ajax_url,type:"POST",data:{action:"mt_get_jury_rankings",nonce:mt_ajax.nonce,limit:10},success:function(a){if(a.success&&a.data.html){let e={};r(".mt-inline-evaluation-form").each(function(){let t=r(this).data("candidate-id");e[t]={},r(this).find(".mt-score-input").each(function(){var a=r(this).attr("name");e[t][a]=r(this).val()})}),t.fadeOut(300,function(){r(this).html(a.data.html).fadeIn(300,function(){n()})})}},error:function(){}})}}n(),0<r(".mt-rankings-section").length&&(window.mtIntervals||(window.mtIntervals={}),window.mtIntervals.inlineRankingsRefresh&&clearInterval(window.mtIntervals.inlineRankingsRefresh),window.mtIntervals.inlineRankingsRefresh=setInterval(o,3e4))})})(jQuery),(s=>{s(document).ready(function(){var a=s(".mt-evaluation-table");function e(a){var t=0,e=0,n=(a.find(".mt-eval-score-input").each(function(){var a=parseFloat(s(this).val());isNaN(a)||(t+=a,e++)}),0<e?t/e:0),a=(a.find(".mt-eval-total-value").text(n.toFixed(1)),a.find(".mt-eval-total-score"));a.removeClass("score-high score-low"),8<=n?a.addClass("score-high"):n<=3&&a.addClass("score-low")}function n(a){var t=parseFloat(a.val());a.removeClass("score-high score-low"),8<=t?a.addClass("score-high"):t<=3&&a.addClass("score-low")}a.length&&(a.on("input change",".mt-eval-score-input",function(){var a=s(this),t=a.closest("tr");n(a),e(t),t.addClass("unsaved").removeClass("saving"),t.find(".mt-btn-save-eval").addClass("unsaved").removeClass("saving")}),a.on("click",".mt-btn-save-eval",function(a){a.preventDefault();var e,r=s(this),i=r.closest("tr");r.hasClass("saving")||(r.addClass("saving").removeClass("unsaved"),i.addClass("saving").removeClass("unsaved"),r.html('<span class="mt-eval-spinner"></span> '+getI18nText("saving","Saving...")),a=r.data("candidate-id"),e={},i.find(".mt-eval-score-input").each(function(){var a=s(this).attr("name"),t=s(this).val();e[a]=t}),a={action:"mt_save_inline_evaluation",nonce:"undefined"!=typeof mt_ajax&&mt_ajax.nonce?mt_ajax.nonce:"",candidate_id:a,scores:e,context:"table"},s.ajax({url:"undefined"!=typeof mt_ajax&&mt_ajax.ajax_url?mt_ajax.ajax_url:"",type:"POST",data:a,dataType:"json",success:function(a){var t;a.success?(i.removeClass("unsaved saving").addClass("saved"),r.removeClass("saving").html('<span class="dashicons dashicons-saved"></span> '+getI18nText("saved","Saved")),setTimeout(function(){r.html('<span class="dashicons dashicons-saved"></span> '+getI18nText("save","Save")),i.removeClass("saved")},1200),a.data&&void 0!==a.data.total_score&&(t=parseFloat(a.data.total_score),i.find(".mt-eval-total-value").text(t.toFixed(1)),i.data("total-score",t),"function"==typeof rerankTable)&&setTimeout(rerankTable,300)):(t="",a&&a.data&&("string"==typeof a.data?t=a.data:a.data.message?t=a.data.message:a.data.errors&&(t=a.data.errors.join(", "))),t=t||getI18nText("error_saving_evaluation","Error saving evaluation"),r.removeClass("saving").addClass("unsaved").html('<span class="dashicons dashicons-warning"></span> '+getI18nText("error","Error")),i.removeClass("saving").addClass("unsaved"),setTimeout(function(){r.html('<span class="dashicons dashicons-saved"></span> '+getI18nText("save","Save"))},2e3),window.MTErrorHandler?MTErrorHandler.showUserError(t):alert(t))},error:function(a,t,e){r.removeClass("saving").addClass("unsaved").html('<span class="dashicons dashicons-warning"></span> '+getI18nText("error","Error")),i.removeClass("saving").addClass("unsaved"),setTimeout(function(){r.html('<span class="dashicons dashicons-saved"></span> '+getI18nText("save","Save"))},2e3);var n=getI18nText("network_error","Network error. Please try again.");if(a.responseJSON&&a.responseJSON.data)n=a.responseJSON.data;else if(a.responseText)try{var s=JSON.parse(a.responseText);s.data&&(n=s.data)}catch(a){}window.MTErrorHandler?MTErrorHandler.handleAjaxError(a,t,e,"jury-rankings-table"):alert(n)}}))}),a.find("th[title]").each(function(){var e=s(this);e.attr("tabindex","0"),e.on("focus mouseenter",function(){var a,t=e.attr("title");t&&(t=s('<div class="mt-tooltip"></div>').text(t).appendTo("body"),a=e.offset(),t.css({top:a.top+e.outerHeight()+4,left:a.left+e.outerWidth()/2-t.outerWidth()/2}),e.data("mt-tooltip",t))}),e.on("blur mouseleave",function(){var a=e.data("mt-tooltip");a&&a.remove()})}),a.find("tbody tr").each(function(){var a=s(this);a.find(".mt-eval-score-input").each(function(){n(s(this))}),e(a)}))})})(jQuery);