!function(n){"use strict";function e(n,e){return"undefined"!=typeof mt_assignments_i18n&&mt_assignments_i18n&&mt_assignments_i18n[n]?mt_assignments_i18n[n]:"undefined"!=typeof mt_admin&&mt_admin&&mt_admin.i18n&&mt_admin.i18n[n]?mt_admin.i18n[n]:"undefined"!=typeof mt_admin_i18n&&mt_admin_i18n&&mt_admin_i18n[n]?mt_admin_i18n[n]:e||""}function t(t){var s={timeout:15e3,type:"POST",url:"undefined"!=typeof mt_admin&&mt_admin.ajax_url?mt_admin.ajax_url:ajaxurl,error:function(n,t,s){var i=e("error","Error")+": ";"timeout"===t?i+=e("request_timeout","Request timed out. Please try again."):n.responseJSON&&n.responseJSON.data?i+=n.responseJSON.data:i+=s||e("unknown_error","An unknown error occurred"),a(i,"error")}};return t.data||(t.data={}),t.data.nonce||(t.data.nonce="undefined"!=typeof mt_admin&&mt_admin.nonce?mt_admin.nonce:n("#mt_admin_nonce").val()),n.ajax(n.extend({},s,t))}function s(n){n.fadeOut(300)}function a(t,s){s=s||"info",n(".mt-notification").remove();var a='<div class="mt-notification notice '+({success:"notice-success",error:"notice-error",warning:"notice-warning",info:"notice-info"}[s]||"notice-info")+' is-dismissible"><p>'+t+'</p><button type="button" class="notice-dismiss"><span class="screen-reader-text">'+e("dismiss_notice","Dismiss this notice.")+"</span></button></div>",i=n(".wrap h1").first();i.length?n(a).insertAfter(i):n(".wrap").prepend(a),"success"===s&&setTimeout(function(){n(".mt-notification").fadeOut(400,function(){n(this).remove()})},5e3),n(".mt-notification .notice-dismiss").on("click",function(){n(this).closest(".mt-notification").fadeOut(400,function(){n(this).remove()})})}n(document).ready(function(){!function(){if(0===n("#mt-auto-assign-btn").length)return;n("#mt-auto-assign-btn").off("click").on("click",function(e){e.preventDefault(),n("#mt-auto-assign-modal").css("display","flex").hide().fadeIn(300)}),n("#mt-manual-assign-btn").off("click").on("click",function(e){e.preventDefault(),n("#mt-manual-assign-modal").css("display","flex").hide().fadeIn(300)}),n(".mt-modal-close").off("click").on("click",function(e){e.preventDefault(),s(n(this).closest(".mt-modal"))}),n(".mt-modal").off("click").on("click",function(e){n(e.target).hasClass("mt-modal")&&s(n(this))}),n("#mt-auto-assign-modal form").off("submit").on("submit",function(i){var o,c,r;i.preventDefault(),o=n("#assignment_method").val(),c=n("#candidates_per_jury").val(),r=n("#clear_existing").is(":checked")?"true":"false",t({data:{action:"mt_auto_assign",method:o,candidates_per_jury:c,clear_existing:r},beforeSend:function(){n('#mt-auto-assign-modal button[type="submit"]').prop("disabled",!0).text(e("processing","Processing..."))},success:function(t){t.success?(a(t.data.message||e("auto_assignment_success","Auto-assignment completed successfully!"),"success"),s(n("#mt-auto-assign-modal")),setTimeout(function(){location.reload()},1500)):a(t.data||e("error_occurred","An error occurred"),"error")},complete:function(){n('#mt-auto-assign-modal button[type="submit"]').prop("disabled",!1).text(e("run_auto_assignment","Run Auto-Assignment"))}})}),n("#mt-manual-assignment-form").off("submit").on("submit",function(i){i.preventDefault(),function(){var i=n("#manual_jury_member").val(),o=[];if(n('input[name="candidate_ids[]"]:checked').each(function(){o.push(n(this).val())}),!i||0===o.length)return void a(e("select_jury_candidates","Please select a jury member and at least one candidate."),"warning");t({data:{action:"mt_manual_assign",jury_member_id:i,candidate_ids:o},beforeSend:function(){n('#mt-manual-assignment-form button[type="submit"]').prop("disabled",!0).text(e("processing","Processing..."))},success:function(t){t.success?(a(t.data.message||e("assignments_created","Assignments created successfully!"),"success"),s(n("#mt-manual-assign-modal")),setTimeout(function(){location.reload()},1500)):a(t.data||e("error_occurred","An error occurred"),"error")},complete:function(){n('#mt-manual-assignment-form button[type="submit"]').prop("disabled",!1).text(e("assign_selected","Assign Selected"))}})}()}),n(document).on("click",".mt-remove-assignment",function(s){s.preventDefault(),function(s){var i=s.data("assignment-id");s.data("jury"),s.data("candidate");if(!confirm(e("confirm_remove_assignment","Are you sure you want to remove this assignment?")))return;t({data:{action:"mt_remove_assignment",assignment_id:i},beforeSend:function(){s.prop("disabled",!0).text(e("processing","Processing..."))},success:function(t){t.success?(s.closest("tr").fadeOut(400,function(){n(this).remove(),0===n(".mt-assignments-table tbody tr").length&&n(".mt-assignments-table tbody").html('<tr><td colspan="8" class="no-items">'+e("no_assignments","No assignments yet")+"</td></tr>")}),a(e("assignment_removed","Assignment removed successfully."),"success")):a(t.data||e("error_occurred","An error occurred"),"error")},complete:function(){s.prop("disabled",!1).text(e("remove","Remove"))}})}(n(this))}),n("#mt-clear-all-btn").off("click").on("click",function(s){s.preventDefault(),function(){if(!confirm(e("confirm_clear_all","Are you sure you want to clear ALL assignments? This cannot be undone.")))return;if(!confirm(e("confirm_clear_all_final","This will remove ALL jury assignments. Are you absolutely sure?")))return;t({data:{action:"mt_clear_all_assignments"},beforeSend:function(){n("#mt-clear-all-btn").prop("disabled",!0).text(e("clearing","Clearing..."))},success:function(n){n.success?(a(e("assignments_cleared","All assignments have been cleared."),"success"),setTimeout(function(){location.reload()},1500)):a(n.data||e("error_occurred","An error occurred"),"error")},complete:function(){n("#mt-clear-all-btn").prop("disabled",!1).html('<span class="dashicons dashicons-trash"></span> '+e("clear_all","Clear All"))}})}()}),n("#mt-export-btn").off("click").on("click",function(t){var s,i,o;t.preventDefault(),s="undefined"!=typeof mt_admin&&mt_admin.ajax_url?mt_admin.ajax_url:ajaxurl,i="undefined"!=typeof mt_admin&&mt_admin.nonce?mt_admin.nonce:n("#mt_admin_nonce").val(),(o=n("<form/>",{action:s,method:"POST"})).append(n("<input/>",{type:"hidden",name:"action",value:"mt_export_assignments"})),o.append(n("<input/>",{type:"hidden",name:"nonce",value:i})),o.appendTo("body").submit().remove(),a(e("export_started","Export started. Download will begin shortly."),"info")}),n("#mt-bulk-actions-btn").off("click").on("click",function(e){var t,s;e.preventDefault(),t=n("#mt-bulk-actions-container"),s=n(".check-column"),t.is(":visible")?(t.slideUp(),s.hide(),n(".mt-assignment-checkbox").prop("checked",!1),n("#mt-select-all-assignments").prop("checked",!1)):(t.slideDown(),s.show())})}()})}(jQuery);
//# sourceMappingURL=mt-assignments.js.map