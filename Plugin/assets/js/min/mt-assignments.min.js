(s=>{function a(e,n){return"undefined"!=typeof mt_assignments_i18n&&mt_assignments_i18n&&mt_assignments_i18n[e]?mt_assignments_i18n[e]:"undefined"!=typeof mt_admin&&mt_admin&&mt_admin.i18n&&mt_admin.i18n[e]?mt_admin.i18n[e]:"undefined"!=typeof mt_admin_i18n&&mt_admin_i18n&&mt_admin_i18n[e]?mt_admin_i18n[e]:n||""}function i(e){var n={timeout:15e3,type:"POST",url:"undefined"!=typeof mt_admin&&mt_admin.ajax_url?mt_admin.ajax_url:ajaxurl,error:function(e,n,t){var s=a("error","Error")+": ";"timeout"===n?s+=a("request_timeout","Request timed out. Please try again."):e.responseJSON&&e.responseJSON.data?s+=e.responseJSON.data:s+=t||a("unknown_error","An unknown error occurred"),c(s,"error")}};e.data||(e.data={}),e.data.nonce||(e.data.nonce="undefined"!=typeof mt_admin&&mt_admin.nonce?mt_admin.nonce:s("#mt_admin_nonce").val()),s.ajax(s.extend({},n,e))}function o(e){e.fadeOut(300)}function c(e,n){n=n||"info",s(".mt-notification").remove();var e='<div class="mt-notification notice '+({success:"notice-success",error:"notice-error",warning:"notice-warning",info:"notice-info"}[n]||"notice-info")+' is-dismissible"><p>'+e+'</p><button type="button" class="notice-dismiss"><span class="screen-reader-text">'+a("dismiss_notice","Dismiss this notice.")+"</span></button></div>",t=s(".wrap h1").first();t.length?s(e).insertAfter(t):s(".wrap").prepend(e),"success"===n&&setTimeout(function(){s(".mt-notification").fadeOut(400,function(){s(this).remove()})},5e3),s(".mt-notification .notice-dismiss").on("click",function(){s(this).closest(".mt-notification").fadeOut(400,function(){s(this).remove()})})}s(document).ready(function(){0!==s("#mt-auto-assign-btn").length&&(s("#mt-auto-assign-btn").off("click").on("click",function(e){e.preventDefault(),s("#mt-auto-assign-modal").css("display","flex").hide().fadeIn(300)}),s("#mt-manual-assign-btn").off("click").on("click",function(e){e.preventDefault(),s("#mt-manual-assign-modal").css("display","flex").hide().fadeIn(300)}),s(".mt-modal-close").off("click").on("click",function(e){e.preventDefault(),o(s(this).closest(".mt-modal"))}),s(".mt-modal").off("click").on("click",function(e){s(e.target).hasClass("mt-modal")&&o(s(this))}),s("#mt-auto-assign-modal form").off("submit").on("submit",function(e){var n,t;e.preventDefault(),e=s("#assignment_method").val(),n=s("#candidates_per_jury").val(),t=s("#clear_existing").is(":checked")?"true":"false",i({data:{action:"mt_auto_assign",method:e,candidates_per_jury:n,clear_existing:t},beforeSend:function(){s('#mt-auto-assign-modal button[type="submit"]').prop("disabled",!0).text(a("processing","Processing..."))},success:function(e){e.success?(c(e.data.message||a("auto_assignment_success","Auto-assignment completed successfully!"),"success"),o(s("#mt-auto-assign-modal")),setTimeout(function(){location.reload()},1500)):c(e.data||a("error_occurred","An error occurred"),"error")},complete:function(){s('#mt-auto-assign-modal button[type="submit"]').prop("disabled",!1).text(a("run_auto_assignment","Run Auto-Assignment"))}})}),s("#mt-manual-assignment-form").off("submit").on("submit",function(e){var n;e.preventDefault(),e=s("#manual_jury_member").val(),n=[],s('input[name="candidate_ids[]"]:checked').each(function(){n.push(s(this).val())}),e&&0!==n.length?i({data:{action:"mt_manual_assign",jury_member_id:e,candidate_ids:n},beforeSend:function(){s('#mt-manual-assignment-form button[type="submit"]').prop("disabled",!0).text(a("processing","Processing..."))},success:function(e){e.success?(c(e.data.message||a("assignments_created","Assignments created successfully!"),"success"),o(s("#mt-manual-assign-modal")),setTimeout(function(){location.reload()},1500)):c(e.data||a("error_occurred","An error occurred"),"error")},complete:function(){s('#mt-manual-assignment-form button[type="submit"]').prop("disabled",!1).text(a("assign_selected","Assign Selected"))}}):c(a("select_jury_candidates","Please select a jury member and at least one candidate."),"warning")}),s(document).on("click",".mt-remove-assignment",function(e){e.preventDefault();var n=s(this),e=n.data("assignment-id");n.data("jury"),n.data("candidate"),confirm(a("confirm_remove_assignment","Are you sure you want to remove this assignment?"))&&i({data:{action:"mt_remove_assignment",assignment_id:e},beforeSend:function(){n.prop("disabled",!0).text(a("processing","Processing..."))},success:function(e){e.success?(n.closest("tr").fadeOut(400,function(){s(this).remove(),0===s(".mt-assignments-table tbody tr").length&&s(".mt-assignments-table tbody").html('<tr><td colspan="8" class="no-items">'+a("no_assignments","No assignments yet")+"</td></tr>")}),c(a("assignment_removed","Assignment removed successfully."),"success")):c(e.data||a("error_occurred","An error occurred"),"error")},complete:function(){n.prop("disabled",!1).text(a("remove","Remove"))}})}),s("#mt-clear-all-btn").off("click").on("click",function(e){e.preventDefault(),confirm(a("confirm_clear_all","Are you sure you want to clear ALL assignments? This cannot be undone."))&&confirm(a("confirm_clear_all_final","This will remove ALL jury assignments. Are you absolutely sure?"))&&i({data:{action:"mt_clear_all_assignments"},beforeSend:function(){s("#mt-clear-all-btn").prop("disabled",!0).text(a("clearing","Clearing..."))},success:function(e){e.success?(c(a("assignments_cleared","All assignments have been cleared."),"success"),setTimeout(function(){location.reload()},1500)):c(e.data||a("error_occurred","An error occurred"),"error")},complete:function(){s("#mt-clear-all-btn").prop("disabled",!1).html('<span class="dashicons dashicons-trash"></span> '+a("clear_all","Clear All"))}})}),s("#mt-export-btn").off("click").on("click",function(e){var n;e.preventDefault(),e="undefined"!=typeof mt_admin&&mt_admin.ajax_url?mt_admin.ajax_url:ajaxurl,n="undefined"!=typeof mt_admin&&mt_admin.nonce?mt_admin.nonce:s("#mt_admin_nonce").val(),(e=s("<form/>",{action:e,method:"POST"})).append(s("<input/>",{type:"hidden",name:"action",value:"mt_export_assignments"})),e.append(s("<input/>",{type:"hidden",name:"nonce",value:n})),e.appendTo("body").submit().remove(),c(a("export_started","Export started. Download will begin shortly."),"info")}),s("#mt-bulk-actions-btn").off("click").on("click",function(e){var n;e.preventDefault(),e=s("#mt-bulk-actions-container"),n=s(".check-column"),e.is(":visible")?(e.slideUp(),n.hide(),s(".mt-assignment-checkbox").prop("checked",!1),s("#mt-select-all-assignments").prop("checked",!1)):(e.slideDown(),n.show())}))})})(jQuery);