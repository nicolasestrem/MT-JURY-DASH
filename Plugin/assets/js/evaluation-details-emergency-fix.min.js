jQuery(document).ready(function(n){"use strict";var t=window.mt_eval_details_i18n||{};function e(){n(".view-details").off("click.mtDetails"),n(".view-details").on("click.mtDetails",function(e){e.preventDefault(),e.stopPropagation();var a=n(this),o=a.data("evaluation-id");if(o){var i=a.closest("tr"),l=i.find("td:eq(2)").text().trim(),d=i.find("td:eq(3)").text().trim(),r=i.find("td:eq(4)").text().trim(),s=i.find("td:eq(5)").text().trim(),m=i.find("td:eq(6)").text().trim(),c=i.find("td:eq(2) a").attr("href")||"#",u=i.find("td:eq(3) a").attr("href")||"#",f=`\n                <div id="mt-evaluation-modal-overlay" class="mt-modal-overlay">\n                    <div id="mt-evaluation-modal" class="mt-modal">\n                        <div class="mt-modal-header">\n                            <h2>${t&&t.modal?t.modal.title:"Evaluation Details"} #${o}</h2>\n                            <button class="mt-modal-close" aria-label="Close">&times;</button>\n                        </div>\n                        <div class="mt-modal-body">\n                            <table class="widefat striped">\n                                <tbody>\n                                    <tr>\n                                        <th style="width: 30%;">Jury Member:</th>\n                                        <td>${"#"!==c?`<a href="${c}" target="_blank">${l}</a>`:l}</td>\n                                    </tr>\n                                    <tr>\n                                        <th>Candidate:</th>\n                                        <td>${"#"!==u?`<a href="${u}" target="_blank">${d}</a>`:d}</td>\n                                    </tr>\n                                    <tr>\n                                        <th>Total Score:</th>\n                                        <td><strong>${r}</strong></td>\n                                    </tr>\n                                    <tr>\n                                        <th>Status:</th>\n                                        <td><span class="status-${s.toLowerCase()}">${s}</span></td>\n                                    </tr>\n                                    <tr>\n                                        <th>Last Updated:</th>\n                                        <td>${m}</td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                            \n                            <div class="mt-modal-notice">\n                                <p><strong>${t&&t.modal?t.modal.note:"Note"}:</strong> ${t&&t.modal?t.modal.temp_message:"Full evaluation details with individual criteria scores would normally appear here. This is a temporary fix while the full AJAX functionality is being restored."}</p>\n                            </div>\n                        </div>\n                        <div class="mt-modal-footer">\n                            <button class="button button-primary mt-modal-close">${t&&t.modal?t.modal.close:"Close"}</button>\n                            ${"#"!==u?`<a href="${u}" class="button" target="_blank">${t&&t.modal?t.modal.view_candidate:"View Candidate"}</a>`:""}\n                            <button class="button button-link-delete mt-delete-evaluation" data-id="${o}">${t&&t.modal?t.modal.delete:"Delete Evaluation"}</button>\n                        </div>\n                    </div>\n                </div>\n            `;if(!n("#mt-evaluation-modal-styles").length){n("head").append('\n                    <style id="mt-evaluation-modal-styles">\n                        .mt-modal-overlay {\n                            position: fixed;\n                            top: 0;\n                            left: 0;\n                            right: 0;\n                            bottom: 0;\n                            background: rgba(0, 0, 0, 0.7);\n                            z-index: 159900;\n                            display: flex;\n                            align-items: center;\n                            justify-content: center;\n                            animation: mtFadeIn 0.3s ease;\n                        }\n                        \n                        .mt-modal {\n                            background: #fff;\n                            max-width: 600px;\n                            width: 90%;\n                            max-height: 80vh;\n                            overflow: auto;\n                            border-radius: 4px;\n                            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);\n                            animation: mtSlideIn 0.3s ease;\n                        }\n                        \n                        .mt-modal-header {\n                            padding: 15px 20px;\n                            border-bottom: 1px solid #ddd;\n                            display: flex;\n                            justify-content: space-between;\n                            align-items: center;\n                        }\n                        \n                        .mt-modal-header h2 {\n                            margin: 0;\n                            font-size: 1.3em;\n                        }\n                        \n                        .mt-modal-close {\n                            background: none;\n                            border: none;\n                            font-size: 24px;\n                            cursor: pointer;\n                            color: #666;\n                            padding: 0;\n                            width: 30px;\n                            height: 30px;\n                            display: flex;\n                            align-items: center;\n                            justify-content: center;\n                        }\n                        \n                        .mt-modal-close:hover {\n                            color: #000;\n                        }\n                        \n                        .mt-modal-body {\n                            padding: 20px;\n                        }\n                        \n                        .mt-modal-body table {\n                            margin-bottom: 20px;\n                        }\n                        \n                        .mt-modal-notice {\n                            background: #f0f0f1;\n                            border-left: 4px solid #72aee6;\n                            padding: 12px;\n                            margin: 15px 0;\n                        }\n                        \n                        .mt-modal-notice p {\n                            margin: 0;\n                        }\n                        \n                        .mt-modal-footer {\n                            padding: 15px 20px;\n                            border-top: 1px solid #ddd;\n                            background: #f9f9f9;\n                            display: flex;\n                            gap: 10px;\n                            justify-content: flex-end;\n                        }\n                        \n                        .status-completed,\n                        .status-submitted {\n                            color: #46b450;\n                            font-weight: 600;\n                        }\n                        \n                        .status-draft {\n                            color: #ffb900;\n                            font-weight: 600;\n                        }\n                        \n                        .status-rejected {\n                            color: #dc3232;\n                            font-weight: 600;\n                        }\n                        \n                        @keyframes mtFadeIn {\n                            from { opacity: 0; }\n                            to { opacity: 1; }\n                        }\n                        \n                        @keyframes mtSlideIn {\n                            from { \n                                transform: translateY(-20px);\n                                opacity: 0;\n                            }\n                            to { \n                                transform: translateY(0);\n                                opacity: 1;\n                            }\n                        }\n                    </style>\n                ')}n("#mt-evaluation-modal-overlay").remove(),n("body").append(f),n(".mt-modal-close, #mt-evaluation-modal-overlay").on("click",function(t){(t.target===this||n(this).hasClass("mt-modal-close"))&&n("#mt-evaluation-modal-overlay").fadeOut(200,function(){n(this).remove()})}),n(".mt-delete-evaluation").on("click",function(){var e=n(this).data("id"),a=t&&t.confirmations?t.confirmations.delete_single:"Are you sure you want to delete this evaluation? This action cannot be undone.";if(confirm(a)){var o="";if(window.MTEvaluations&&window.MTEvaluations.nonce?o=window.MTEvaluations.nonce:n("#_wpnonce").length&&(o=n("#_wpnonce").val()),o)window.location.href=`admin.php?page=mt-evaluations&action=delete&id=${e}&_wpnonce=${o}`;else{var i=t&&t.errors?t.errors.token_missing:"Security token not found. Please refresh the page and try again.";alert(i)}}}),n(document).on("keydown.mtModal",function(t){27===t.keyCode&&(n("#mt-evaluation-modal-overlay").fadeOut(200,function(){n(this).remove()}),n(document).off("keydown.mtModal"))})}})}function a(){n("#doaction, #doaction2").off("click.mtBulk").on("click.mtBulk",function(e){if("delete"===n(this).prev("select").val()){var a=[];if(n('input[name="evaluation[]"]:checked').each(function(){a.push(n(this).val())}),0===a.length){var o=t&&t.confirmations?t.confirmations.select_evaluation:"Please select at least one evaluation to delete.";return alert(o),e.preventDefault(),!1}var i=t&&t.confirmations&&t.confirmations.delete_multiple?t.confirmations.delete_multiple.replace("%s",a.length):`Are you sure you want to delete ${a.length} evaluation(s)? This action cannot be undone.`;if(!confirm(i))return e.preventDefault(),!1;var l="";if(window.MTEvaluations&&window.MTEvaluations.nonce?l=window.MTEvaluations.nonce:n("#_wpnonce").length&&(l=n("#_wpnonce").val()),!l)return alert("Security token not found. Please refresh the page and try again."),e.preventDefault(),!1;var d=n(`\n                    <form method="post" action="admin.php?page=mt-evaluations">\n                        <input type="hidden" name="action" value="bulk_delete">\n                        <input type="hidden" name="evaluations" value="${a.join(",")}">\n                        <input type="hidden" name="_wpnonce" value="${l}">\n                    </form>\n                `);n("body").append(d),d.submit()}})}(n("body").hasClass("toplevel_page_mt-evaluations")||window.location.href.includes("page=mt-evaluations")||n(".view-details[data-evaluation-id]").length)&&(e(),a(),n(document).on("ajaxComplete",function(){setTimeout(function(){n(".view-details").length&&(e(),a())},100)}))});