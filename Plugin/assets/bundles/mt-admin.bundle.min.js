("ontouchstart"in window||navigator.maxTouchPoints>0)&&jQuery(document).ready(function(t){window.MTEventManager?MTEventManager.on("touchstart",".mt-evaluation-slider, .mt-score-slider, .ui-slider-handle",function(e){var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];t(this).trigger("mousedown",n)},"admin_touch"):t(document).on("touchstart.mt_admin",".mt-evaluation-slider, .mt-score-slider, .ui-slider-handle",function(e){var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];t(this).trigger("mousedown",n)}),t(".mt-evaluation-slider, .mt-score-slider").css({"min-height":"44px","touch-action":"pan-y"}),t("body").addClass("mt-touch-enabled")}),"undefined"==typeof mt_admin&&(window.mt_admin={ajax_url:ajaxurl||"/wp-admin/admin-ajax.php",nonce:$("#mt_admin_nonce").val()||"",admin_url:"/wp-admin/",i18n:{confirm_remove_assignment:"Are you sure you want to remove this assignment?",assignment_removed:"Assignment removed successfully.",error_occurred:"An error occurred. Please try again.",no_assignments:"No assignments yet",processing:"Processing...",select_jury_and_candidates:"Please select a jury member and at least one candidate.",assignments_created:"Assignments created successfully.",assign_selected:"Assign Selected",confirm_clear_all:"Are you sure you want to clear ALL assignments? This cannot be undone.",confirm_clear_all_second:"This will remove ALL jury assignments. Are you absolutely sure?",clearing:"Clearing...",clear_all:"Clear All",all_assignments_cleared:"All assignments have been cleared.",export_started:"Export started. Download will begin shortly."}}),void 0===mt_admin.i18n&&(mt_admin.i18n={confirm_remove_assignment:"Are you sure you want to remove this assignment?",assignment_removed:"Assignment removed successfully.",error_occurred:"An error occurred. Please try again.",no_assignments:"No assignments yet",processing:"Processing...",select_jury_and_candidates:"Please select a jury member and at least one candidate.",assignments_created:"Assignments created successfully.",assign_selected:"Assign Selected",confirm_clear_all:"Are you sure you want to clear ALL assignments? This cannot be undone.",confirm_clear_all_second:"This will remove ALL jury assignments. Are you absolutely sure?",clearing:"Clearing...",clear_all:"Clear All",all_assignments_cleared:"All assignments have been cleared.",export_started:"Export started. Download will begin shortly."}),function(t){"use strict";function e(){"function"==typeof t.fn.tooltip&&t(".mt-tooltip").tooltip()}window.mtShowNotification=function(e,n){n=n||"info",t(".mt-notification").remove();const a=`\n            <div class="mt-notification notice ${{success:"notice-success",error:"notice-error",warning:"notice-warning",info:"notice-info"}[n]||"notice-info"} is-dismissible">\n                <p>${e}</p>\n                <button type="button" class="notice-dismiss">\n                    <span class="screen-reader-text">Dismiss this notice.</span>\n                </button>\n            </div>\n        `,i=t(".wrap h1").first();i.length?t(a).insertAfter(i):t(".wrap").prepend(a),"success"===n&&setTimeout(function(){t(".mt-notification").fadeOut(400,function(){t(this).remove()})},5e3),t(document).on("click.mt_admin",".mt-notification .notice-dismiss",function(){t(this).closest(".mt-notification").fadeOut(400,function(){t(this).remove()})})},window.setButtonLoading=function(t,e,n){if(e)t.addClass("loading").prop("disabled",!0),n&&t.data("original-text",n);else{t.removeClass("loading").prop("disabled",!1);const e=t.data("original-text");e&&t.text(e)}},window.setLoadingOverlay=function(t,e){e?t.addClass("mt-loading-overlay active"):t.removeClass("active")},window.refreshDashboardWidget=function(n,a){const i=t("#"+n);i.length?(i.addClass("mt-widget-loading"),t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_refresh_widget",widget:n,nonce:mt_admin.nonce},success:function(t){t.success&&t.data&&t.data.html?(i.html(t.data.html),e(),a&&a(!0)):a&&a(!1)},error:function(){a&&a(!1)},complete:function(){i.removeClass("mt-widget-loading")}})):a&&a(!1)},window.refreshDashboardWidgets=function(t){Array.isArray(t)||(t=[t]),t.forEach(function(t){refreshDashboardWidget(t)})};const n={init:function(){this.bindEvents(),this.initBulkActions()},bindEvents:function(){t(document).on("click","#mt-auto-assign-btn",t=>{t.preventDefault(),this.showAutoAssignModal()}),t(document).on("click","#mt-manual-assign-btn",t=>{t.preventDefault(),this.showManualAssignModal()}),t(document).on("click","#mt-bulk-actions-btn",t=>{t.preventDefault(),this.toggleBulkActions()}),t(document).on("click","#mt-export-btn",t=>{t.preventDefault(),this.exportAssignments()}),t(document).on("click","#mt-clear-all-btn",t=>{t.preventDefault(),this.clearAllAssignments()}),t(document).on("click",".mt-remove-assignment",e=>{e.preventDefault(),this.removeAssignment(t(e.currentTarget))}),t(document).on("click",".mt-modal-close",e=>{e.preventDefault(),t(".mt-modal").fadeOut(300)}),t(document).on("submit","#mt-manual-assignment-form",t=>{t.preventDefault(),this.submitManualAssignment()}),t(document).on("submit","#mt-auto-assign-modal form",t=>{t.preventDefault(),this.submitAutoAssignment()}),t(document).on("change","#mt-filter-jury, #mt-filter-status",()=>{this.applyFilters()}),t(document).on("keyup","#mt-assignment-search",function(){const e=t(this).val();n.filterAssignments(e)})},initBulkActions:function(){t(document).on("change","#mt-select-all-assignments",function(){t(".mt-assignment-checkbox").prop("checked",t(this).prop("checked"))}),t(document).on("click","#mt-apply-bulk-action",t=>{t.preventDefault(),this.applyBulkAction()}),t(document).on("click","#mt-cancel-bulk-action",t=>{t.preventDefault(),this.toggleBulkActions()})},showAutoAssignModal:function(){t("#mt-auto-assign-modal").fadeIn(300)},showManualAssignModal:function(){t("#mt-manual-assign-modal").fadeIn(300)},submitAutoAssignment:function(){const e=t("#assignment_method").val(),n=t("#candidates_per_jury").val(),a=t("#clear_existing").is(":checked")?"true":"false";t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_auto_assign",nonce:mt_admin.nonce,method:e,candidates_per_jury:n,clear_existing:a},beforeSend:()=>{t('#mt-auto-assign-modal button[type="submit"]').prop("disabled",!0).text(mt_admin.i18n.processing||"Processing...")},success:e=>{e.success?(mtShowNotification(e.data.message||mt_admin.i18n.assignments_created,"success"),t("#mt-auto-assign-modal").fadeOut(300),setTimeout(()=>{location.reload()},1500)):mtShowNotification(e.data||mt_admin.i18n.error_occurred,"error")},error:()=>{mtShowNotification(mt_admin.i18n.error_occurred,"error")},complete:()=>{t('#mt-auto-assign-modal button[type="submit"]').prop("disabled",!1).text("Run Auto-Assignment")}})},submitManualAssignment:function(){const e=t("#manual_jury_member").val(),n=[];t('input[name="candidate_ids[]"]:checked').each(function(){n.push(t(this).val())}),e&&0!==n.length?t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_manual_assign",nonce:mt_admin.nonce,jury_member_id:e,candidate_ids:n},beforeSend:()=>{t('#mt-manual-assignment-form button[type="submit"]').prop("disabled",!0).text(mt_admin.i18n.processing||"Processing...")},success:e=>{e.success?(mtShowNotification(e.data.message||mt_admin.i18n.assignments_created,"success"),t("#mt-manual-assign-modal").fadeOut(300),setTimeout(()=>{location.reload()},1500)):mtShowNotification(e.data||mt_admin.i18n.error_occurred,"error")},error:()=>{mtShowNotification(mt_admin.i18n.error_occurred,"error")},complete:()=>{t('#mt-manual-assignment-form button[type="submit"]').prop("disabled",!1).text(mt_admin.i18n.assign_selected)}}):mtShowNotification(mt_admin.i18n.select_jury_and_candidates,"warning")},removeAssignment:function(e){const n=e.data("assignment-id");e.data("jury"),e.data("candidate");confirm(mt_admin.i18n.confirm_remove_assignment)&&t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_remove_assignment",nonce:mt_admin.nonce,assignment_id:n},beforeSend:()=>{e.prop("disabled",!0).text(mt_admin.i18n.processing||"Processing...")},success:n=>{n.success?(e.closest("tr").fadeOut(400,function(){t(this).remove(),0===t(".mt-assignments-table tbody tr").length&&t(".mt-assignments-table tbody").html('<tr><td colspan="8" class="no-items">'+mt_admin.i18n.no_assignments+"</td></tr>")}),mtShowNotification(mt_admin.i18n.assignment_removed,"success")):mtShowNotification(n.data||mt_admin.i18n.error_occurred,"error")},error:()=>{mtShowNotification(mt_admin.i18n.error_occurred,"error")},complete:()=>{e.prop("disabled",!1).text(mt_admin&&mt_admin.i18n&&mt_admin.i18n.remove?mt_admin.i18n.remove:"Entfernen")}})},clearAllAssignments:function(){confirm(mt_admin.i18n.confirm_clear_all)&&confirm(mt_admin.i18n.confirm_clear_all_second)&&t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_clear_all_assignments",nonce:mt_admin.nonce},beforeSend:()=>{t("#mt-clear-all-btn").prop("disabled",!0).text(mt_admin.i18n.clearing||"Clearing...")},success:t=>{t.success?(mtShowNotification(mt_admin.i18n.all_assignments_cleared,"success"),location.reload()):mtShowNotification(t.data||mt_admin.i18n.error_occurred,"error")},error:()=>{mtShowNotification(mt_admin.i18n.error_occurred,"error")},complete:()=>{t("#mt-clear-all-btn").prop("disabled",!1).html('<span class="dashicons dashicons-trash"></span> '+mt_admin.i18n.clear_all)}})},exportAssignments:function(){const e=t("<form/>",{action:mt_admin.ajax_url,method:"POST"});e.append(t("<input/>",{type:"hidden",name:"action",value:"mt_export_assignments"})),e.append(t("<input/>",{type:"hidden",name:"nonce",value:mt_admin.nonce})),e.appendTo("body").submit().remove(),mtShowNotification(mt_admin.i18n.export_started,"info")},toggleBulkActions:function(){const e=t("#mt-bulk-actions-container"),n=t(".check-column");e.is(":visible")?(e.slideUp(),n.hide(),t(".mt-assignment-checkbox").prop("checked",!1),t("#mt-select-all-assignments").prop("checked",!1)):(e.slideDown(),n.show())},applyBulkAction:function(){const e=t("#mt-bulk-action-select").val(),n=[];t(".mt-assignment-checkbox:checked").each(function(){n.push(t(this).val())}),e?0!==n.length?"remove"===e?this.bulkRemoveAssignments(n):"export"===e?this.bulkExportAssignments(n):"reassign"===e&&this.showReassignModal(n):mtShowNotification(mt_admin.i18n.select_assignments||"Please select at least one assignment","warning"):mtShowNotification(mt_admin.i18n.select_bulk_action||"Please select a bulk action","warning")},bulkRemoveAssignments:function(e){confirm("Are you sure you want to remove the selected assignments?")&&t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_bulk_remove_assignments",nonce:mt_admin.nonce,assignment_ids:e},beforeSend:()=>{t("#mt-apply-bulk-action").prop("disabled",!0).text("Processing...")},success:t=>{t.success?(mtShowNotification(t.data.message||"Assignments removed successfully","success"),location.reload()):mtShowNotification(t.data||"An error occurred","error")},error:()=>{mtShowNotification("An error occurred","error")},complete:()=>{t("#mt-apply-bulk-action").prop("disabled",!1).text("Apply")}})},bulkExportAssignments:function(e){const n=t("<form/>",{action:mt_admin.ajax_url,method:"POST"});n.append(t("<input/>",{type:"hidden",name:"action",value:"mt_export_assignments"})),n.append(t("<input/>",{type:"hidden",name:"nonce",value:mt_admin.nonce})),e.forEach(e=>{n.append(t("<input/>",{type:"hidden",name:"assignment_ids[]",value:e}))}),n.appendTo("body").submit().remove()},filterAssignments:function(e){const n=t(".mt-assignments-table tbody tr");if(!e)return void n.show();const a=e.toLowerCase();n.each(function(){t(this).text().toLowerCase().includes(a)?t(this).show():t(this).hide()})},applyFilters:function(){const e=t("#mt-filter-jury").val(),n=t("#mt-filter-status").val();t(".mt-assignments-table tbody tr").each(function(){let a=!0;const i=t(this);if(e){i.find(".mt-assignment-checkbox").data("jury-id")!=e&&(a=!1)}if(n&&a){i.find(".mt-status").text().toLowerCase()!==n&&(a=!1)}a?i.show():i.hide()})},showReassignModal:function(e){this.pendingReassignments=e,0===t("#mt-reassign-modal").length&&this.createReassignModal(),t("#mt-reassign-modal").fadeIn(300)},createReassignModal:function(){const e=t("#mt-filter-jury option").clone(),n=`\n                <div id="mt-reassign-modal" class="mt-modal" style="display: none;">\n                    <div class="mt-modal-content">\n                        <h2>${mt_admin.i18n.reassign_assignments||"Reassign Assignments"}</h2>\n                        <p>${mt_admin.i18n.reassign_description||"Select a new jury member to reassign the selected assignments to:"}</p>\n                        <form id="mt-reassign-form">\n                            <div class="mt-form-group">\n                                <label for="reassign_jury_member">${mt_admin.i18n.new_jury_member||"New Jury Member"}</label>\n                                <select name="new_jury_member_id" id="reassign_jury_member" class="widefat" required>\n                                    <option value="">${mt_admin.i18n.select_jury_member||"Select Jury Member"}</option>\n                                </select>\n                            </div>\n                            <div class="mt-modal-actions">\n                                <button type="submit" class="button button-primary">${mt_admin.i18n.reassign||"Reassign"}</button>\n                                <button type="button" class="button mt-modal-close">${mt_admin.i18n.cancel||"Cancel"}</button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            `;t("body").append(n),t("#reassign_jury_member").html(e),t(document).on("click","#mt-reassign-modal .mt-modal-close",e=>{e.preventDefault(),t("#mt-reassign-modal").fadeOut(300)}),t(document).on("submit","#mt-reassign-form",t=>{t.preventDefault(),this.submitReassignment()})},submitReassignment:function(){const e=t("#reassign_jury_member").val();e?this.pendingReassignments&&0!==this.pendingReassignments.length?t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_bulk_reassign_assignments",nonce:mt_admin.nonce,assignment_ids:this.pendingReassignments,new_jury_member_id:e},beforeSend:()=>{t('#mt-reassign-form button[type="submit"]').prop("disabled",!0).text(mt_admin.i18n.processing||"Processing...")},success:e=>{e.success?(mtShowNotification(e.data.message||"Assignments reassigned successfully","success"),t("#mt-reassign-modal").fadeOut(300),location.reload()):mtShowNotification(e.data||"An error occurred","error")},error:()=>{mtShowNotification(mt_admin.i18n.error_occurred||"An error occurred","error")},complete:()=>{t('#mt-reassign-form button[type="submit"]').prop("disabled",!1).text(mt_admin.i18n.reassign||"Reassign")}}):mtShowNotification(mt_admin.i18n.no_assignments_selected||"No assignments selected","warning"):mtShowNotification(mt_admin.i18n.select_jury_member||"Please select a jury member","warning")}};window.MTEvaluationManager={init:function(){this.bindEvents()},getConfirmMessage:function(t){return{delete:mt_admin.i18n.confirm_delete_evaluations||"Are you sure you want to permanently delete the selected evaluations? This cannot be undone.",approve:mt_admin.i18n.confirm_approve_evaluations||"Are you sure you want to approve the selected evaluations?",reject:mt_admin.i18n.confirm_reject_evaluations||"Are you sure you want to reject the selected evaluations?",reset:mt_admin.i18n.confirm_reset_evaluations||"Are you sure you want to reset the selected evaluations to draft status?",export:mt_admin.i18n.confirm_export_evaluations||"Are you sure you want to export the selected evaluations?"}[t]||"Are you sure you want to "+t+" the selected evaluations?"},bindEvents:function(){t(document).on("click",".view-details",e=>{const n=t(e.currentTarget),a=n.data("evaluation-id");this.viewDetails(a,n)}),t(document).on("click","#cb-select-all-1, #cb-select-all-2",this.handleSelectAll),t('input[name="evaluation[]"]').on("click",this.handleSingleSelect),t(document).on("click","#doaction, #doaction2",e=>{const n=t(e.currentTarget).prev("select").val();this.applyBulkAction(n)})},viewDetails:function(e,n){const a=this.createModal();a.data("trigger",n),a.find(".mt-modal-body").html('<div class="mt-loading">Loading evaluation details...</div>'),a.fadeIn(300,function(){a.find(".mt-modal-body").focus()}),t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_get_evaluation_details",nonce:mt_admin.nonce,evaluation_id:e},success:t=>{if(t.success){const e=this.renderEvaluationDetails(t.data);a.find(".mt-modal-body").html(e)}else a.find(".mt-modal-body").html('<div class="notice notice-error"><p>'+(t.data?.message||"Failed to load evaluation details")+"</p></div>")},error:()=>{a.find(".mt-modal-body").html('<div class="notice notice-error"><p>An error occurred while loading evaluation details</p></div>')}})},createModal:function(){let e=t("#mt-evaluation-modal");if(0===e.length){const n='\n                    <div id="mt-evaluation-modal" class="mt-modal" role="dialog" aria-modal="true" aria-labelledby="mt-modal-title" style="display:none;">\n                        <div class="mt-modal-overlay" aria-hidden="true"></div>\n                        <div class="mt-modal-content">\n                            <div class="mt-modal-header">\n                                <h2 id="mt-modal-title">Evaluation Details</h2>\n                                <button class="mt-modal-close" aria-label="Close dialog" type="button">&times;</button>\n                            </div>\n                            <div class="mt-modal-body" tabindex="0"></div>\n                        </div>\n                    </div>\n                ';t("body").append(n),e=t("#mt-evaluation-modal"),e.find(".mt-modal-close, .mt-modal-overlay").on("click",()=>{this.closeModal(e)}),t(document).on("keydown",t=>{"Escape"===t.key&&e.is(":visible")&&this.closeModal(e)})}return e},closeModal:function(t){t.fadeOut(300,function(){t.data("trigger")&&t.data("trigger").focus()})},renderEvaluationDetails:function(t){let e="";for(const[n,a]of Object.entries(t.scores))e+=`\n                    <div class="mt-score-item">\n                        <label>${a.label}:</label>\n                        <span class="mt-score-value">${a.value}/10</span>\n                        <div class="mt-score-bar">\n                            <div class="mt-score-fill" style="width: ${10*a.value}%"></div>\n                        </div>\n                    </div>\n                `;return`\n                <div class="mt-evaluation-details">\n                    <div class="mt-detail-section">\n                        <h3>Basic Information</h3>\n                        <table class="mt-detail-table">\n                            <tr>\n                                <th>Jury Member:</th>\n                                <td>${t.jury_member}</td>\n                            </tr>\n                            <tr>\n                                <th>Candidate:</th>\n                                <td>${t.candidate}</td>\n                            </tr>\n                            <tr>\n                                <th>Organization:</th>\n                                <td>${t.organization||"-"}</td>\n                            </tr>\n                            <tr>\n                                <th>Categories:</th>\n                                <td>${t.categories||"-"}</td>\n                            </tr>\n                            <tr>\n                                <th>Status:</th>\n                                <td><span class="mt-status mt-status-${t.status}">${t.status}</span></td>\n                            </tr>\n                        </table>\n                    </div>\n                    <div class="mt-detail-section">\n                        <h3>Scores</h3>\n                        ${e}\n                        <div class="mt-score-summary">\n                            <strong>${mt_evaluations_i18n.total_score_label||"Total Score:"}</strong> ${t.total_score.toFixed(1)}/50\n                            <br>\n                            <strong>${mt_evaluations_i18n.average_score_label||"Average Score:"}</strong> ${t.average_score.toFixed(1)}/10\n                        </div>\n                    </div>\n                    ${t.comments?`\n                        <div class="mt-detail-section">\n                            <h3>Comments</h3>\n                            <div class="mt-comments">${t.comments}</div>\n                        </div>\n                    `:""}\n                    <div class="mt-detail-section mt-timestamps">\n                        <small>\n                            Created: ${t.created_at}<br>\n                            Last Updated: ${t.updated_at}\n                        </small>\n                    </div>\n                </div>\n            `},handleSelectAll:function(){const e=t(this).prop("checked");t('input[name="evaluation[]"]').prop("checked",e),t("#cb-select-all-1, #cb-select-all-2").prop("checked",e)},handleSingleSelect:function(){const e=t('input[name="evaluation[]"]').length===t('input[name="evaluation[]"]:checked').length;t("#cb-select-all-1, #cb-select-all-2").prop("checked",e)},applyBulkAction:function(e){if("-1"===e)return void mtShowNotification(mt_admin.i18n.select_bulk_action||"Please select a bulk action","warning");const n=[];if(t('input[name="evaluation[]"]:checked').each(function(){n.push(t(this).val())}),0===n.length)return void mtShowNotification(mt_admin.i18n.select_assignments||"Please select at least one evaluation","warning");const a=this.getConfirmMessage(e);confirm(a)&&this.performBulkAction(e,n)},performBulkAction:function(e,n){const a=t("#doaction, #doaction2"),i=a.first().val(),s=t(".spinner");s.length&&s.addClass("is-active"),t.ajax({url:mt_admin.ajax_url,type:"POST",data:{action:"mt_bulk_evaluation_action",bulk_action:e,evaluation_ids:n,nonce:mt_admin.nonce},beforeSend:function(){a.prop("disabled",!0).val(mt_admin.i18n.processing||"Processing..."),t('input[name="evaluation[]"]:checked').closest("tr").addClass("processing").css("opacity","0.6")},success:function(e){e.success?(mtShowNotification(e.data.message||"Bulk action completed successfully","success"),setTimeout(function(){location.reload()},1e3)):(mtShowNotification(e.data||"An error occurred","error"),t('input[name="evaluation[]"]:checked').closest("tr").removeClass("processing").css("opacity","1"))},error:function(e,n,a){const i=mt_admin.i18n.error_occurred||"An error occurred. Please try again.";mtShowNotification(i+" ("+a+")","error"),t('input[name="evaluation[]"]:checked').closest("tr").removeClass("processing").css("opacity","1")},complete:function(){a.prop("disabled",!1).val(i||"Apply"),s.length&&s.removeClass("is-active")}})}},t(document).ready(function(){e(),t.fn.select2&&t(".mt-select2").select2(),t.fn.datepicker&&t(".mt-datepicker").datepicker({dateFormat:"yy-mm-dd"}),(t("#mt-auto-assign-btn").length>0||t(".mt-assignments-table").length>0)&&n.init(),t("body").hasClass("mobility-trailblazers_page_mt-evaluations")&&window.MTEvaluationManager.init()})}(jQuery);
;
!function(t){"use strict";window.MTEvaluations={init:function(){this.bindEvents(),this.setupBulkActions()},bindEvents:function(){var a=this;t(document).on("click",".view-details",function(n){n.preventDefault();var e=t(this).data("evaluation-id");a.showDetails(e)}),t(document).on("click",".mt-delete-evaluation",function(n){n.preventDefault();var e=t(this).data("id");confirm(mt_evaluations_i18n.confirm_delete||"Are you sure you want to delete this evaluation?")&&a.deleteEvaluation(e)}),t(document).on("click",".mt-modal-close, .mt-modal-overlay",function(n){(t(n.target).hasClass("mt-modal-close")||t(n.target).hasClass("mt-modal-overlay"))&&a.closeModal()}),t(document).on("keydown",function(n){27===n.keyCode&&t("#mt-evaluation-modal").length&&a.closeModal()})},setupBulkActions:function(){var a=this;t("#doaction, #doaction2").on("click",function(n){var e=t(this).prev("select").val();if("-1"!==e){n.preventDefault();var o=[];t('input[name="evaluation[]"]:checked').each(function(){o.push(t(this).val())}),0!==o.length?("delete"!==e||confirm(mt_evaluations_i18n.confirm_bulk_delete||"Are you sure you want to delete the selected evaluations?"))&&a.bulkAction(e,o):alert(mt_evaluations_i18n.no_selection||"Please select at least one evaluation.")}}),t("#cb-select-all-1, #cb-select-all-2").on("change",function(){var a=t(this).prop("checked");t('input[name="evaluation[]"]').prop("checked",a),t("#cb-select-all-1, #cb-select-all-2").prop("checked",a)})},showDetails:function(a){var n=this;n.showLoading(),t.ajax({url:ajaxurl,type:"POST",data:{action:"mt_get_evaluation_details",evaluation_id:a,nonce:mt_evaluations_vars.nonce||t("#_wpnonce").val()},success:function(t){t.success&&t.data?n.displayModal(t.data):(n.closeModal(),alert(t.data||"Failed to load evaluation details."))},error:function(){n.closeModal(),alert("Error loading evaluation details.")}})},displayModal:function(a){t("#mt-evaluation-modal-wrapper").remove();var n="";a.scores&&t.each(a.scores,function(t,a){var e=a.value/10*100;n+=`\n                        <div class="mt-score-row">\n                            <div class="mt-score-label">${a.label}</div>\n                            <div class="mt-score-bar">\n                                <div class="mt-score-fill" style="width: ${e}%"></div>\n                            </div>\n                            <div class="mt-score-value">${a.value.toFixed(1)}</div>\n                        </div>\n                    `});var e=`\n                <div id="mt-evaluation-modal-wrapper" class="mt-modal-wrapper">\n                    <div class="mt-modal-overlay"></div>\n                    <div id="mt-evaluation-modal" class="mt-modal">\n                        <div class="mt-modal-header">\n                            <h2>${mt_evaluations_i18n.evaluation_details||"Evaluation Details"} #${a.id}</h2>\n                            <button type="button" class="mt-modal-close" aria-label="Close">\n                                <span aria-hidden="true">&times;</span>\n                            </button>\n                        </div>\n                        <div class="mt-modal-body">\n                            <div class="mt-evaluation-info">\n                                <table class="widefat striped">\n                                    <tbody>\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.jury_member||"Jury Member"}:</th>\n                                            <td>${a.jury_member}</td>\n                                        </tr>\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.candidate||"Candidate"}:</th>\n                                            <td>${a.candidate}</td>\n                                        </tr>\n                                        ${a.organization?`\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.organization||"Organization"}:</th>\n                                            <td>${a.organization}</td>\n                                        </tr>`:""}\n                                        ${a.categories?`\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.categories||"Categories"}:</th>\n                                            <td>${a.categories}</td>\n                                        </tr>`:""}\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.status||"Status"}:</th>\n                                            <td><span class="mt-status mt-status-${a.status}">${a.status}</span></td>\n                                        </tr>\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.created||"Created"}:</th>\n                                            <td>${a.created_at}</td>\n                                        </tr>\n                                        <tr>\n                                            <th>${mt_evaluations_i18n.updated||"Last Updated"}:</th>\n                                            <td>${a.updated_at}</td>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                            </div>\n                            \n                            <div class="mt-evaluation-scores">\n                                <h3>${mt_evaluations_i18n.scores||"Evaluation Scores"}</h3>\n                                ${n}\n                                <div class="mt-score-summary">\n                                    <div class="mt-total-score">\n                                        <strong>${mt_evaluations_i18n.total_score||"Total Score"}:</strong>\n                                        <span class="mt-score-total">${a.total_score.toFixed(1)} / 50</span>\n                                    </div>\n                                    <div class="mt-average-score">\n                                        <strong>${mt_evaluations_i18n.average_score||"Average"}:</strong>\n                                        <span class="mt-score-average">${a.average_score.toFixed(2)}</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            ${a.comments?`\n                            <div class="mt-evaluation-comments">\n                                <h3>${mt_evaluations_i18n.comments||"Comments"}</h3>\n                                <div class="mt-comments-text">${a.comments}</div>\n                            </div>`:""}\n                        </div>\n                        <div class="mt-modal-footer">\n                            <button type="button" class="button button-primary mt-modal-close">\n                                ${mt_evaluations_i18n.close||"Close"}\n                            </button>\n                            <button type="button" class="button button-link-delete mt-delete-evaluation" data-id="${a.id}">\n                                ${mt_evaluations_i18n.delete||"Delete Evaluation"}\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            `;t("body").append(e),t(document).trigger("mt:evaluation:modal:opened",[a])},showLoading:function(){var a=`\n                <div id="mt-evaluation-modal-wrapper" class="mt-modal-wrapper">\n                    <div class="mt-modal-overlay"></div>\n                    <div class="mt-modal-loading">\n                        <div class="spinner is-active"></div>\n                        <p>${mt_evaluations_i18n.loading||"Loading..."}</p>\n                    </div>\n                </div>\n            `;t("body").append(a)},closeModal:function(){t("#mt-evaluation-modal-wrapper").fadeOut(200,function(){t(this).remove()}),t(document).trigger("mt:evaluation:modal:closed")},deleteEvaluation:function(a){var n=this;t.ajax({url:ajaxurl,type:"POST",data:{action:"mt_delete_evaluation",evaluation_id:a,nonce:mt_evaluations_vars.nonce||t("#_wpnonce").val()},success:function(e){e.success?(n.closeModal(),t('input[value="'+a+'"][name="evaluation[]"]').closest("tr").fadeOut(400,function(){t(this).remove(),0===t('input[name="evaluation[]"]').length&&location.reload()}),n.showNotice(e.data.message||"Evaluation deleted successfully","success")):alert(e.data||"Failed to delete evaluation")},error:function(){alert("Error deleting evaluation")}})},bulkAction:function(a,n){t.ajax({url:ajaxurl,type:"POST",data:{action:"mt_bulk_evaluation_action",bulk_action:a,evaluation_ids:n,nonce:mt_evaluations_vars.nonce||t("#_wpnonce").val()},success:function(t){t.success?location.reload():alert(t.data||"Failed to perform bulk action")},error:function(){alert("Error performing bulk action")}})},showNotice:function(a,n){var e=`\n                <div class="notice notice-${n} is-dismissible mt-admin-notice">\n                    <p>${a}</p>\n                    <button type="button" class="notice-dismiss">\n                        <span class="screen-reader-text">Dismiss this notice.</span>\n                    </button>\n                </div>\n            `;t(".mt-admin-notice").remove(),t(".wrap > h1").after(e),setTimeout(function(){t(".mt-admin-notice").fadeOut(400,function(){t(this).remove()})},5e3),t(".mt-admin-notice .notice-dismiss").on("click",function(){t(this).closest(".notice").fadeOut(400,function(){t(this).remove()})})}},t(document).ready(function(){(t(".view-details[data-evaluation-id]").length>0||window.location.href.includes("page=mt-evaluations"))&&MTEvaluations.init()})}(jQuery);
;
!function(n){"use strict";function e(n,e){return"undefined"!=typeof mt_assignments_i18n&&mt_assignments_i18n&&mt_assignments_i18n[n]?mt_assignments_i18n[n]:"undefined"!=typeof mt_admin&&mt_admin&&mt_admin.i18n&&mt_admin.i18n[n]?mt_admin.i18n[n]:"undefined"!=typeof mt_admin_i18n&&mt_admin_i18n&&mt_admin_i18n[n]?mt_admin_i18n[n]:e||""}function t(t){var s={timeout:15e3,type:"POST",url:"undefined"!=typeof mt_admin&&mt_admin.ajax_url?mt_admin.ajax_url:ajaxurl,error:function(n,t,s){var i=e("error","Error")+": ";"timeout"===t?i+=e("request_timeout","Request timed out. Please try again."):n.responseJSON&&n.responseJSON.data?i+=n.responseJSON.data:i+=s||e("unknown_error","An unknown error occurred"),a(i,"error")}};return t.data||(t.data={}),t.data.nonce||(t.data.nonce="undefined"!=typeof mt_admin&&mt_admin.nonce?mt_admin.nonce:n("#mt_admin_nonce").val()),n.ajax(n.extend({},s,t))}function s(n){n.fadeOut(300)}function a(t,s){s=s||"info",n(".mt-notification").remove();var a='<div class="mt-notification notice '+({success:"notice-success",error:"notice-error",warning:"notice-warning",info:"notice-info"}[s]||"notice-info")+' is-dismissible"><p>'+t+'</p><button type="button" class="notice-dismiss"><span class="screen-reader-text">'+e("dismiss_notice","Dismiss this notice.")+"</span></button></div>",i=n(".wrap h1").first();i.length?n(a).insertAfter(i):n(".wrap").prepend(a),"success"===s&&setTimeout(function(){n(".mt-notification").fadeOut(400,function(){n(this).remove()})},5e3),n(".mt-notification .notice-dismiss").on("click",function(){n(this).closest(".mt-notification").fadeOut(400,function(){n(this).remove()})})}n(document).ready(function(){!function(){if(0===n("#mt-auto-assign-btn").length)return;n("#mt-auto-assign-btn").off("click").on("click",function(e){e.preventDefault(),n("#mt-auto-assign-modal").css("display","flex").hide().fadeIn(300)}),n("#mt-manual-assign-btn").off("click").on("click",function(e){e.preventDefault(),n("#mt-manual-assign-modal").css("display","flex").hide().fadeIn(300)}),n(".mt-modal-close").off("click").on("click",function(e){e.preventDefault(),s(n(this).closest(".mt-modal"))}),n(".mt-modal").off("click").on("click",function(e){n(e.target).hasClass("mt-modal")&&s(n(this))}),n("#mt-auto-assign-modal form").off("submit").on("submit",function(i){var o,c,r;i.preventDefault(),o=n("#assignment_method").val(),c=n("#candidates_per_jury").val(),r=n("#clear_existing").is(":checked")?"true":"false",t({data:{action:"mt_auto_assign",method:o,candidates_per_jury:c,clear_existing:r},beforeSend:function(){n('#mt-auto-assign-modal button[type="submit"]').prop("disabled",!0).text(e("processing","Processing..."))},success:function(t){t.success?(a(t.data.message||e("auto_assignment_success","Auto-assignment completed successfully!"),"success"),s(n("#mt-auto-assign-modal")),setTimeout(function(){location.reload()},1500)):a(t.data||e("error_occurred","An error occurred"),"error")},complete:function(){n('#mt-auto-assign-modal button[type="submit"]').prop("disabled",!1).text(e("run_auto_assignment","Run Auto-Assignment"))}})}),n("#mt-manual-assignment-form").off("submit").on("submit",function(i){i.preventDefault(),function(){var i=n("#manual_jury_member").val(),o=[];if(n('input[name="candidate_ids[]"]:checked').each(function(){o.push(n(this).val())}),!i||0===o.length)return void a(e("select_jury_candidates","Please select a jury member and at least one candidate."),"warning");t({data:{action:"mt_manual_assign",jury_member_id:i,candidate_ids:o},beforeSend:function(){n('#mt-manual-assignment-form button[type="submit"]').prop("disabled",!0).text(e("processing","Processing..."))},success:function(t){t.success?(a(t.data.message||e("assignments_created","Assignments created successfully!"),"success"),s(n("#mt-manual-assign-modal")),setTimeout(function(){location.reload()},1500)):a(t.data||e("error_occurred","An error occurred"),"error")},complete:function(){n('#mt-manual-assignment-form button[type="submit"]').prop("disabled",!1).text(e("assign_selected","Assign Selected"))}})}()}),n(document).on("click",".mt-remove-assignment",function(s){s.preventDefault(),function(s){var i=s.data("assignment-id");s.data("jury"),s.data("candidate");if(!confirm(e("confirm_remove_assignment","Are you sure you want to remove this assignment?")))return;t({data:{action:"mt_remove_assignment",assignment_id:i},beforeSend:function(){s.prop("disabled",!0).text(e("processing","Processing..."))},success:function(t){t.success?(s.closest("tr").fadeOut(400,function(){n(this).remove(),0===n(".mt-assignments-table tbody tr").length&&n(".mt-assignments-table tbody").html('<tr><td colspan="8" class="no-items">'+e("no_assignments","No assignments yet")+"</td></tr>")}),a(e("assignment_removed","Assignment removed successfully."),"success")):a(t.data||e("error_occurred","An error occurred"),"error")},complete:function(){s.prop("disabled",!1).text(e("remove","Remove"))}})}(n(this))}),n("#mt-clear-all-btn").off("click").on("click",function(s){s.preventDefault(),function(){if(!confirm(e("confirm_clear_all","Are you sure you want to clear ALL assignments? This cannot be undone.")))return;if(!confirm(e("confirm_clear_all_final","This will remove ALL jury assignments. Are you absolutely sure?")))return;t({data:{action:"mt_clear_all_assignments"},beforeSend:function(){n("#mt-clear-all-btn").prop("disabled",!0).text(e("clearing","Clearing..."))},success:function(n){n.success?(a(e("assignments_cleared","All assignments have been cleared."),"success"),setTimeout(function(){location.reload()},1500)):a(n.data||e("error_occurred","An error occurred"),"error")},complete:function(){n("#mt-clear-all-btn").prop("disabled",!1).html('<span class="dashicons dashicons-trash"></span> '+e("clear_all","Clear All"))}})}()}),n("#mt-export-btn").off("click").on("click",function(t){var s,i,o;t.preventDefault(),s="undefined"!=typeof mt_admin&&mt_admin.ajax_url?mt_admin.ajax_url:ajaxurl,i="undefined"!=typeof mt_admin&&mt_admin.nonce?mt_admin.nonce:n("#mt_admin_nonce").val(),(o=n("<form/>",{action:s,method:"POST"})).append(n("<input/>",{type:"hidden",name:"action",value:"mt_export_assignments"})),o.append(n("<input/>",{type:"hidden",name:"nonce",value:i})),o.appendTo("body").submit().remove(),a(e("export_started","Export started. Download will begin shortly."),"info")}),n("#mt-bulk-actions-btn").off("click").on("click",function(e){var t,s;e.preventDefault(),t=n("#mt-bulk-actions-container"),s=n(".check-column"),t.is(":visible")?(t.slideUp(),s.hide(),n(".mt-assignment-checkbox").prop("checked",!1),n("#mt-select-all-assignments").prop("checked",!1)):(t.slideDown(),s.show())})}()})}(jQuery);
;
jQuery(document).ready(function(t){"use strict";var e;t("#upload_header_image").on("click",function(a){a.preventDefault(),e||(e=wp.media({title:mt_settings_i18n&&mt_settings_i18n.media?mt_settings_i18n.media.title:"Choose Header Background Image",button:{text:mt_settings_i18n&&mt_settings_i18n.media?mt_settings_i18n.media.button:"Use this image"},multiple:!1,library:{type:"image"}})).on("select",function(){var a=e.state().get("selection").first().toJSON();t("#header_image_url").val(a.url);var n=t("#header_image_preview"),i=t(".mt-image-preview");n.attr("src",a.url),i.show();var o=i.find(".mt-clear-image");if(0===o.length){var m=mt_settings_i18n&&mt_settings_i18n.media?mt_settings_i18n.media.remove:"Remove Image";i.append(' <button type="button" class="button mt-clear-image" style="margin-top: 10px;">'+m+"</button>")}else o.show();t('input[name="submit"]').prop("disabled",!1)}),e.open()}),t(document).on("click",".mt-clear-image",function(e){e.preventDefault(),t("#header_image_url").val(""),t("#header_image_preview").attr("src",""),t(".mt-image-preview").hide(),t(this).hide(),t('input[name="submit"]').prop("disabled",!1)});var a=t('input[name="mt_candidate_presentation[enable_animations]"]');t('input[name="mt_candidate_presentation[enable_hover_effects]"]');if(a.length){var n=mt_settings_i18n&&mt_settings_i18n.media?mt_settings_i18n.media.preview:"Preview Animation";a.parent().append(' <button type="button" class="button button-small mt-preview-animation">'+n+"</button>")}t(document).on("click",".mt-preview-animation",function(e){e.preventDefault();var a=t(this);a.addClass("mt-animate-preview"),setTimeout(function(){a.removeClass("mt-animate-preview")},1e3)}),t('input[name="mt_dashboard_settings[primary_color]"]').on("change",function(){var e=t(this).val();t(".mt-color-preview-primary").css("background-color",e)}),t('input[name="mt_dashboard_settings[secondary_color]"]').on("change",function(){var e=t(this).val();t(".mt-color-preview-secondary").css("background-color",e)}),t("form").on("submit",function(e){var a={courage:parseFloat(t('input[name="weight_courage"]').val()),innovation:parseFloat(t('input[name="weight_innovation"]').val()),implementation:parseFloat(t('input[name="weight_implementation"]').val()),relevance:parseFloat(t('input[name="weight_relevance"]').val()),visibility:parseFloat(t('input[name="weight_visibility"]').val())};for(var n in a)if(isNaN(a[n])||a[n]<0||a[n]>10){var i=mt_settings_i18n&&mt_settings_i18n.validation?mt_settings_i18n.validation.weights:"Please enter valid weights between 0 and 10";return alert(i),e.preventDefault(),!1}if(t('input[name="mt_remove_data_on_uninstall"]').is(":checked")){var o=mt_settings_i18n&&mt_settings_i18n.validation?mt_settings_i18n.validation.data_deletion_warning:"WARNING: You have enabled data deletion on uninstall. This will permanently delete all plugin data when the plugin is removed. Are you sure?";if(!confirm(o))return e.preventDefault(),!1}});t("head").append("<style>.mt-animate-preview {    animation: mt-preview-pulse 1s ease-in-out;}@keyframes mt-preview-pulse {    0% { transform: scale(1); }    50% { transform: scale(1.1); background-color: #C1693C; color: white; }    100% { transform: scale(1); }}.mt-color-preview-primary, .mt-color-preview-secondary {    display: inline-block;    width: 30px;    height: 30px;    border-radius: 4px;    margin-left: 10px;    vertical-align: middle;    border: 1px solid #ccc;}</style>"),t(document).on("click",".mt-preview-animation-speed",function(e){e.preventDefault();const a=t("#animation_speed").val(),n=t('<div class="mt-animation-preview-box">Animation Preview</div>');t(".mt-animation-preview-box").remove(),t(this).after(n),n.addClass("mt-anim-"+a+" mtFadeInUp"),setTimeout(function(){n.fadeOut(function(){t(this).remove()})},2e3)}),t(document).on("click",".mt-preview-animation-style",function(e){e.preventDefault();const a=t("#animation_style").val(),n=t('<div class="mt-animation-preview-box">Animation Preview</div>');t(".mt-animation-preview-box").remove(),t(this).after(n);n.addClass({fade:"mtFadeIn",slide:"mtSlideInLeft",zoom:"mtZoomIn",rotate:"mtRotateIn",flip:"mtFlipInY",bounce:"mtZoomInBounce"}[a]||"mtFadeIn"),setTimeout(function(){n.fadeOut(function(){t(this).remove()})},2e3)});t("head").append("<style>.mt-animation-preview-box {    display: inline-block;    margin-left: 10px;    padding: 10px 20px;    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);    color: white;    border-radius: 5px;    font-weight: bold;    box-shadow: 0 4px 6px rgba(0,0,0,0.1);}@keyframes mtFadeIn { from { opacity: 0; } to { opacity: 1; } }@keyframes mtFadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }@keyframes mtSlideInLeft { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }@keyframes mtZoomIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }@keyframes mtRotateIn { from { opacity: 0; transform: rotate(-180deg) scale(0.8); } to { opacity: 1; transform: rotate(0) scale(1); } }@keyframes mtFlipInY { from { opacity: 0; transform: perspective(600px) rotateY(90deg); } to { opacity: 1; transform: perspective(600px) rotateY(0); } }@keyframes mtZoomInBounce {    0% { opacity: 0; transform: scale(0.3); }    50% { transform: scale(1.05); }    70% { transform: scale(0.95); }    100% { opacity: 1; transform: scale(1); }}.mtFadeIn { animation: mtFadeIn 0.5s ease forwards; }.mtFadeInUp { animation: mtFadeInUp 0.5s ease forwards; }.mtSlideInLeft { animation: mtSlideInLeft 0.5s ease forwards; }.mtZoomIn { animation: mtZoomIn 0.5s ease forwards; }.mtRotateIn { animation: mtRotateIn 0.5s ease forwards; }.mtFlipInY { animation: mtFlipInY 0.5s ease forwards; }.mtZoomInBounce { animation: mtZoomInBounce 0.8s ease forwards; }.mt-anim-instant { animation-duration: 0.1s !important; }.mt-anim-fast { animation-duration: 0.2s !important; }.mt-anim-normal { animation-duration: 0.3s !important; }.mt-anim-slow { animation-duration: 0.5s !important; }.mt-anim-slower { animation-duration: 0.8s !important; }</style>")});
;
!function(t){"use strict";const e={ajaxUrl:mt_debug.ajax_url||ajaxurl,nonce:mt_debug.nonce,activeTab:null,init:function(){this.bindEvents(),this.initActiveTab(),this.initTooltips(),this.startAutoRefresh()},bindEvents:function(){t(document).on("click",".nav-tab",this.handleTabClick.bind(this)),t(document).on("submit",".diagnostic-form",this.handleDiagnosticSubmit.bind(this)),t(document).on("click",".mt-run-diagnostic",this.runDiagnostic.bind(this)),t(document).on("click",".mt-export-diagnostics",this.exportDiagnostics.bind(this)),t(document).on("click",".mt-execute-script",this.executeScript.bind(this)),t(document).on("click",".mt-run-maintenance",this.runMaintenance.bind(this)),t(document).on("click",".mt-copy-sysinfo",this.copySystemInfo.bind(this)),t(document).on("click",".mt-export-sysinfo",this.exportSystemInfo.bind(this)),t(document).on("click",".mt-refresh-widget",this.refreshWidget.bind(this))},initActiveTab:function(){const t=new URLSearchParams(window.location.search);this.activeTab=t.get("tab")||"diagnostics"},initTooltips:function(){t.fn.tooltip&&t(".mt-tooltip").tooltip({position:{my:"center bottom-10",at:"center top"}})},startAutoRefresh:function(){setInterval(()=>{"diagnostics"===this.activeTab&&this.refreshWidget({target:t('[data-widget="system_status"]')[0]})},3e4)},handleTabClick:function(e){const i=t(e.currentTarget).attr("href").match(/tab=([^&]+)/);i&&(this.activeTab=i[1])},handleDiagnosticSubmit:function(t){t.preventDefault(),this.runDiagnostic(t)},runDiagnostic:function(e){e.preventDefault();const i=t(e.currentTarget),s=i.is("form")?i.find('button[name="run_diagnostic"]'):i,n=s.closest("form").find("#diagnostic_type").val()||"full";s.prop("disabled",!0).addClass("updating-message");const o=s.text();s.text(mt_debug.i18n.running||"Running..."),t.ajax({url:this.ajaxUrl,type:"POST",data:{action:"mt_run_diagnostic",nonce:this.nonce,diagnostic_type:n},success:t=>{t.success?(this.displayDiagnosticResults(t.data),this.showNotification(mt_debug.i18n.diagnostic_complete||"Diagnostic complete","success")):this.showNotification(t.data||mt_debug.i18n.diagnostic_failed||"Diagnostic failed","error")},error:()=>{this.showNotification(mt_debug.i18n.network_error||"Network error occurred","error")},complete:()=>{s.prop("disabled",!1).removeClass("updating-message").text(o)}})},displayDiagnosticResults:function(e){let i=t(".mt-diagnostics-tab .diagnostic-results");i.length||(i=t('<div class="diagnostic-results mt-debug-section"></div>'),t(".mt-diagnostics-tab").append(i));let s="<h3>"+(mt_debug.i18n.diagnostic_results||"Diagnostic Results")+"</h3>";if(s+='<div class="mt-diagnostic-timestamp">Run at: '+(e.timestamp||(new Date).toLocaleString())+"</div>",e.diagnostics)for(const[t,i]of Object.entries(e.diagnostics)){if(s+='<div class="mt-diagnostic-section">',s+="<h4>"+this.formatSectionName(t)+"</h4>",s+='<div class="mt-diagnostic-items">',"object"==typeof i&&null!==i)for(const[t,e]of Object.entries(i)){const i=this.getDiagnosticStatus(t,e);s+='<div class="mt-diagnostic-item '+i.class+'">',s+='<span class="mt-diagnostic-label">'+this.formatLabel(t)+":</span>",s+='<span class="mt-diagnostic-value">'+this.formatValue(e)+"</span>",i.icon&&(s+='<span class="dashicons '+i.icon+'"></span>'),s+="</div>"}else s+='<div class="mt-diagnostic-item">'+i+"</div>";s+="</div></div>"}i.html(s),t("html, body").animate({scrollTop:i.offset().top-100},500)},formatSectionName:function(t){return t.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},formatLabel:function(t){return t.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},formatValue:function(t){return"boolean"==typeof t?t?"✓ Yes":"✗ No":"object"==typeof t&&null!==t?JSON.stringify(t,null,2):String(t)},getDiagnosticStatus:function(t,e){return t.includes("error")||t.includes("failed")?{class:"mt-diagnostic-error",icon:"dashicons-warning"}:t.includes("warning")||t.includes("deprecated")?{class:"mt-diagnostic-warning",icon:"dashicons-info"}:!0===e||t.includes("success")||t.includes("valid")?{class:"mt-diagnostic-success",icon:"dashicons-yes-alt"}:!1===e||t.includes("invalid")?{class:"mt-diagnostic-error",icon:"dashicons-dismiss"}:{class:"",icon:""}},exportDiagnostics:function(e){e.preventDefault();const i=t(e.currentTarget);i.prop("disabled",!0),t.ajax({url:this.ajaxUrl,type:"POST",data:{action:"mt_export_diagnostics",nonce:this.nonce},success:t=>{t.success?(this.downloadJSON(t.data.data,t.data.filename),this.showNotification(mt_debug.i18n.export_complete||"Export complete","success")):this.showNotification(t.data||mt_debug.i18n.export_failed||"Export failed","error")},error:()=>{this.showNotification(mt_debug.i18n.network_error||"Network error occurred","error")},complete:()=>{i.prop("disabled",!1)}})},executeScript:function(e){e.preventDefault();const i=t(e.currentTarget),s=i.data("script"),n=i.data("dangerous");n&&!confirm(mt_debug.i18n.confirm_dangerous||"This is a dangerous operation. Are you sure?")||(i.prop("disabled",!0).addClass("updating-message"),t.ajax({url:this.ajaxUrl,type:"POST",data:{action:"mt_execute_debug_script",nonce:this.nonce,script:s,params:{confirm:!!n}},success:t=>{t.success?(this.showScriptOutput(t.data),this.showNotification(mt_debug.i18n.script_complete||"Script executed","success")):t.data&&t.data.requires_confirmation?confirm(t.data.message)&&this.executeScript(e):this.showNotification(t.data||mt_debug.i18n.script_failed||"Script failed","error")},error:()=>{this.showNotification(mt_debug.i18n.network_error||"Network error occurred","error")},complete:()=>{i.prop("disabled",!1).removeClass("updating-message")}}))},showScriptOutput:function(e){const i=t('<div class="mt-modal">').html(`\n                <div class="mt-modal-content">\n                    <h3>${mt_debug.i18n.script_output||"Script Output"}</h3>\n                    <div class="mt-script-output">${e.output||"<p>No output generated</p>"}</div>\n                    ${e.errors&&e.errors.length?`<div class="notice notice-error">\n                            <p>${mt_debug.i18n.errors_occurred||"Errors occurred"}:</p>\n                            <ul>${e.errors.map(t=>`<li>${this.escapeHtml(t.message)}</li>`).join("")}</ul>\n                        </div>`:""}\n                    <button class="button mt-close-modal">${mt_debug.i18n.close||"Close"}</button>\n                </div>\n            `);t("body").append(i),i.on("click",".mt-close-modal, .mt-modal",function(e){(e.target===this||t(e.target).hasClass("mt-close-modal"))&&i.remove()})},runMaintenance:function(e){e.preventDefault();const i=t(e.currentTarget),s=i.data("category"),n=i.data("operation"),o=i.data("dangerous");o&&!confirm(mt_debug.i18n.confirm_dangerous||"This is a dangerous operation. Are you sure?")||(i.prop("disabled",!0).addClass("updating-message"),t.ajax({url:this.ajaxUrl,type:"POST",data:{action:"mt_run_maintenance",nonce:this.nonce,category:s,operation:n,params:{confirm:!!o}},success:t=>{t.success?(this.showNotification(t.data.message||mt_debug.i18n.operation_complete||"Operation complete","success"),t.data.data):t.data&&t.data.requires_password?this.promptPassword(s,n):this.showNotification(t.data||mt_debug.i18n.operation_failed||"Operation failed","error")},error:()=>{this.showNotification(mt_debug.i18n.network_error||"Network error occurred","error")},complete:()=>{i.prop("disabled",!1).removeClass("updating-message")}}))},promptPassword:function(e,i){const s=prompt(mt_debug.i18n.enter_password||"Enter your admin password:");s&&t.ajax({url:this.ajaxUrl,type:"POST",data:{action:"mt_run_maintenance",nonce:this.nonce,category:e,operation:i,params:{confirm:!0,password:s}},success:t=>{t.success?this.showNotification(t.data.message||mt_debug.i18n.operation_complete||"Operation complete","success"):this.showNotification(t.data||mt_debug.i18n.operation_failed||"Operation failed","error")}})},refreshWidget:function(e){e.preventDefault();const i=t(e.target).closest(".mt-widget"),s=i.data("widget");i.addClass("updating"),t.ajax({url:this.ajaxUrl,type:"POST",data:{action:"mt_refresh_debug_widget",nonce:this.nonce,widget_id:s},success:t=>{t.success&&i.find(".mt-widget-content").html(t.data.html)},complete:()=>{i.removeClass("updating")}})},downloadJSON:function(t,e){const i=new Blob([t],{type:"application/json"}),s=URL.createObjectURL(i),n=document.createElement("a");n.href=s,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)},showNotification:function(e,i="info"){const s=t(`\n                <div class="notice notice-${i} is-dismissible mt-notification">\n                    <p>${e}</p>\n                    <button type="button" class="notice-dismiss">\n                        <span class="screen-reader-text">${mt_debug.i18n.dismiss||"Dismiss"}</span>\n                    </button>\n                </div>\n            `);t(".wrap h1").first().after(s),setTimeout(()=>{s.fadeOut(()=>s.remove())},5e3),s.on("click",".notice-dismiss",function(){s.fadeOut(()=>s.remove())})},escapeHtml:function(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,t=>e[t])},copySystemInfo:function(e){e.preventDefault();t(e.currentTarget);const i=t("#system-info-export");i.length&&(i[0].select(),document.execCommand("copy"),this.showNotification(mt_debug.i18n.copied||"Copied to clipboard","success"))},exportSystemInfo:function(e){e.preventDefault(),t.ajax({url:this.ajaxUrl,type:"POST",data:{action:"mt_get_system_info",nonce:this.nonce},success:t=>{if(t.success){const e="mt-sysinfo-"+(new Date).toISOString().slice(0,10)+".json";this.downloadJSON(JSON.stringify(t.data,null,2),e)}}})}};t(document).ready(function(){t(".mt-debug-center").length&&e.init()})}(jQuery);
;
jQuery(document).ready(function(t){window.showTestModal=function(){t("#test-modal").remove();var e=t("<div>",{id:"test-modal",css:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.8)",zIndex:"9999999",display:"flex",alignItems:"center",justifyContent:"center"}}),o=t("<div>",{css:{background:"white",padding:"30px",borderRadius:"8px",maxWidth:"500px"}});o.append(t("<h2>").text("Test Modal"),t("<p>").text("If you can see this, modals can work!"),t("<button>").text("Close").on("click",function(){t("#test-modal").remove()})),e.append(o),t("body").append(e)},t("#mt-auto-assign-btn").off("click").on("click",function(e){e.preventDefault(),e.stopPropagation();var o=t("#mt-auto-assign-modal"),n=o.find(".mt-modal-content");return o.detach().appendTo("body"),o.css({position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.8)",zIndex:"9999999",display:"flex",alignItems:"center",justifyContent:"center"}),n.css({background:"white",padding:"30px",borderRadius:"8px",maxWidth:"600px",width:"90%",maxHeight:"90vh",overflowY:"auto",position:"relative",zIndex:"10000000"}),!1}),t("#mt-manual-assign-btn").off("click").on("click",function(e){e.preventDefault(),e.stopPropagation();var o=t("#mt-manual-assign-modal"),n=o.find(".mt-modal-content");return o.detach().appendTo("body"),o.css({position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.8)",zIndex:"9999999",display:"flex",alignItems:"center",justifyContent:"center"}),n.css({background:"white",padding:"30px",borderRadius:"8px",maxWidth:"600px",width:"90%",maxHeight:"90vh",overflowY:"auto",position:"relative",zIndex:"10000000"}),!1}),t(document).on("click",".mt-modal-close",function(e){e.preventDefault(),t(this).closest(".mt-modal").hide()}),t(document).on("click",".mt-modal",function(e){t(e.target).hasClass("mt-modal")&&t(this).hide()})});